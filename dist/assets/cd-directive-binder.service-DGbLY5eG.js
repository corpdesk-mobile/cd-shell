class a{constructor(e){this.valid=!0,console.log("CdFormGroup::_constructor()/01"),this.controls=e}get value(){const e={};for(const[t,r]of Object.entries(this.controls))e[t]=r.value;return e}validateAll(){const e={};this.valid=!0;for(const[t,r]of Object.entries(this.controls)){const s=r.validate();e[t]=s,s&&(this.valid=!1)}return e}markAllAsTouched(){for(const e of Object.values(this.controls))e.markAsTouched()}reset(){for(const e of Object.values(this.controls))e.reset()}}class d{constructor(e=null,t=[]){this._errors=[],this.touched=!1,this.dirty=!1,this._value=e,this._validators=t}get value(){return this._value}get valid(){return this._errors.length===0}get errors(){return this._errors}get error(){return this._errors.length>0?this._errors[0]:null}setValue(e){this._value!==e&&(this._value=e,this.dirty=!0),this.validate()}markAsTouched(){this.touched=!0}validate(){this._errors=[];for(const e of this._validators){const t=e(this._value);t&&this._errors.push(t)}return this.error}reset(e=null){this._value=e,this._errors=[],this.touched=!1,this.dirty=!1}}class h{static required(e){return t=>t==null||t===""?e||"This field is required":null}static minLength(e,t){return r=>r&&r.length<e?t||`Minimum length is ${e}`:null}static email(e){return t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)?null:e||"Invalid email address"}}class u{constructor(e,t,r){this.uiSystem="bootstrap-538",this.eventListeners=[],console.log("CdDirectiveBinderService::constructor()/start"),this.form=e,this.controllerInstance=r,this.formSelector=t,typeof window<"u"&&window.CD_ACTIVE_UISYSTEM&&(this.uiSystem=window.CD_ACTIVE_UISYSTEM,console.log(`[Binder] UI-System set to: ${this.uiSystem} (via window.CD_ACTIVE_UISYSTEM)`))}async bindToDom(){if(console.log("[CdDirectiveBinderService][bindToDom] start"),this.formElement=document.querySelector(this.formSelector),!this.formElement){console.error(`[Binder] Form not found: ${this.formSelector}`);return}this.dispatchLifecycleEvent("cd:form:bound"),Object.entries(this.form.controls).forEach(([t,r])=>{const s=this.formElement.querySelector(`[name="${t}"][cdFormControl]`);if(!s)return;const o=n=>{const c=n.target;r.setValue(c.value),this.applyValidationStyles({[t]:r.error})},i=()=>{r.markAsTouched(),this.applyValidationStyles({[t]:r.error})};s.addEventListener("input",o),s.addEventListener("blur",i),this.eventListeners.push({element:s,event:"input",handler:o}),this.eventListeners.push({element:s,event:"blur",handler:i}),s.value=r.value,this.applyValidationStyles({[t]:r.error})}),this.formElement.querySelectorAll("*").forEach(t=>{Array.from(t.attributes).forEach(r=>{const s=r.name.match(/^\(([^)]+)\)$/);if(!s)return;const o=s[1],i=r.value,n=c=>this.invokeDirectiveMethod(i,c);t.addEventListener(o,n),this.eventListeners.push({element:t,event:o,handler:n})})})}unbindAllDomEvents(){console.log(`[Binder] Unbinding ${this.eventListeners.length} listeners`),this.eventListeners.forEach(({element:e,event:t,handler:r})=>{e.removeEventListener(t,r)}),this.eventListeners=[],this.dispatchLifecycleEvent("cd:form:unbound")}dispatchLifecycleEvent(e){const t=new CustomEvent(e,{bubbles:!0,detail:{formSelector:this.formSelector,uiSystem:this.uiSystem,controller:this.controllerInstance}});document.dispatchEvent(t),console.log(`[Binder] Fired event: ${e}`)}invokeDirectiveMethod(e,t){var r;try{const s=e.match(/^([a-zA-Z0-9_]+)\s*\(([^)]*)\)/);if(!s)return;const o=s[1],i=(r=s[2])==null?void 0:r.includes("$event"),n=this.controllerInstance;n&&typeof n[o]=="function"?n[o].call(n,i?t:void 0):console.warn(`[Binder] Method not found: ${o}`)}catch(s){console.error(`[Binder] Error invoking directive method: ${e}`,s)}}validateAll(){const e=this.form.validateAll();this.applyValidationStyles(e)}applyValidationStyles(e){for(const[t,r]of Object.entries(e)){const s=this.formElement.querySelector(`[name="${t}"]`),o=this.formElement.querySelector(`[data-error-for="${t}"]`);s&&(s.classList.remove("cd-valid","cd-invalid"),r?(s.classList.add("cd-invalid"),o&&(o.textContent=r)):(s.classList.add("cd-valid"),o&&(o.textContent="")))}}}export{a as C,d as a,h as b,u as c};
