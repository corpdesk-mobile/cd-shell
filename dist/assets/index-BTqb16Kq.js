const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-bOvGPjop.js","assets/cd-directive-binder.service-DGbLY5eG.js","assets/index-BEx0eJtE.js"])))=>i.map(i=>d[i]);
(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=t(n);fetch(n.href,o)}})();var rt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ji(i){if(i.__esModule)return i;var e=i.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(i).forEach(function(r){var n=Object.getOwnPropertyDescriptor(i,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return i[r]}})}),t}/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var zt;(function(i){(function(e){var t=typeof globalThis=="object"?globalThis:typeof rt=="object"?rt:typeof self=="object"?self:typeof this=="object"?this:a(),r=n(i);typeof t.Reflect<"u"&&(r=n(t.Reflect,r)),e(r,t),typeof t.Reflect>"u"&&(t.Reflect=i);function n(l,f){return function(v,g){Object.defineProperty(l,v,{configurable:!0,writable:!0,value:g}),f&&f(v,g)}}function o(){try{return Function("return this;")()}catch{}}function s(){try{return(0,eval)("(function() { return this; })()")}catch{}}function a(){return o()||s()}})(function(e,t){var r=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",o=n&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",s=n&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",a=typeof Object.create=="function",l={__proto__:[]}instanceof Array,f=!a&&!l,v={create:a?function(){return ht(Object.create(null))}:l?function(){return ht({__proto__:null})}:function(){return ht({})},has:f?function(c,d){return r.call(c,d)}:function(c,d){return d in c},get:f?function(c,d){return r.call(c,d)?c[d]:void 0}:function(c,d){return c[d]}},g=Object.getPrototypeOf(Function),L=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Vr(),x=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Gr(),R=typeof WeakMap=="function"?WeakMap:Wr(),z=n?Symbol.for("@reflect-metadata:registry"):void 0,F=Ur(),G=Nr(F);function V(c,d,p,b){if(E(p)){if(!B(c))throw new TypeError;if(!ce(d))throw new TypeError;return te(c,d)}else{if(!B(c))throw new TypeError;if(!y(d))throw new TypeError;if(!y(b)&&!E(b)&&!u(b))throw new TypeError;return u(b)&&(b=void 0),p=C(p),me(c,d,p,b)}}e("decorate",V);function U(c,d){function p(b,T){if(!y(b))throw new TypeError;if(!E(T)&&!Ce(T))throw new TypeError;ge(c,d,b,T)}return p}e("metadata",U);function K(c,d,p,b){if(!y(p))throw new TypeError;return E(b)||(b=C(b)),ge(c,d,p,b)}e("defineMetadata",K);function Z(c,d,p){if(!y(d))throw new TypeError;return E(p)||(p=C(p)),fe(c,d,p)}e("hasMetadata",Z);function re(c,d,p){if(!y(d))throw new TypeError;return E(p)||(p=C(p)),pe(c,d,p)}e("hasOwnMetadata",re);function ue(c,d,p){if(!y(d))throw new TypeError;return E(p)||(p=C(p)),oe(c,d,p)}e("getMetadata",ue);function ne(c,d,p){if(!y(d))throw new TypeError;return E(p)||(p=C(p)),Te(c,d,p)}e("getOwnMetadata",ne);function de(c,d){if(!y(c))throw new TypeError;return E(d)||(d=C(d)),ve(c,d)}e("getMetadataKeys",de);function se(c,d){if(!y(c))throw new TypeError;return E(d)||(d=C(d)),X(c,d)}e("getOwnMetadataKeys",se);function ye(c,d,p){if(!y(d))throw new TypeError;if(E(p)||(p=C(p)),!y(d))throw new TypeError;E(p)||(p=C(p));var b=Be(d,p,!1);return E(b)?!1:b.OrdinaryDeleteMetadata(c,d,p)}e("deleteMetadata",ye);function te(c,d){for(var p=c.length-1;p>=0;--p){var b=c[p],T=b(d);if(!E(T)&&!u(T)){if(!ce(T))throw new TypeError;d=T}}return d}function me(c,d,p,b){for(var T=c.length-1;T>=0;--T){var q=c[T],Y=q(d,p,b);if(!E(Y)&&!u(Y)){if(!y(Y))throw new TypeError;b=Y}}return b}function fe(c,d,p){var b=pe(c,d,p);if(b)return!0;var T=He(d);return u(T)?!1:fe(c,T,p)}function pe(c,d,p){var b=Be(d,p,!1);return E(b)?!1:D(b.OrdinaryHasOwnMetadata(c,d,p))}function oe(c,d,p){var b=pe(c,d,p);if(b)return Te(c,d,p);var T=He(d);if(!u(T))return oe(c,T,p)}function Te(c,d,p){var b=Be(d,p,!1);if(!E(b))return b.OrdinaryGetOwnMetadata(c,d,p)}function ge(c,d,p,b){var T=Be(p,b,!0);T.OrdinaryDefineOwnMetadata(c,d,p,b)}function ve(c,d){var p=X(c,d),b=He(c);if(b===null)return p;var T=ve(b,d);if(T.length<=0)return p;if(p.length<=0)return T;for(var q=new x,Y=[],I=0,S=p;I<S.length;I++){var A=S[I],w=q.has(A);w||(q.add(A),Y.push(A))}for(var _=0,j=T;_<j.length;_++){var A=j[_],w=q.has(A);w||(q.add(A),Y.push(A))}return Y}function X(c,d){var p=Be(c,d,!1);return p?p.OrdinaryOwnMetadataKeys(c,d):[]}function be(c){if(c===null)return 1;switch(typeof c){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return c===null?1:6;default:return 6}}function E(c){return c===void 0}function u(c){return c===null}function h(c){return typeof c=="symbol"}function y(c){return typeof c=="object"?c!==null:typeof c=="function"}function O(c,d){switch(be(c)){case 0:return c;case 1:return c;case 2:return c;case 3:return c;case 4:return c;case 5:return c}var p="string",b=Se(c,o);if(b!==void 0){var T=b.call(c,p);if(y(T))throw new TypeError;return T}return k(c)}function k(c,d){var p,b,T;{var q=c.toString;if(J(q)){var b=q.call(c);if(!y(b))return b}var p=c.valueOf;if(J(p)){var b=p.call(c);if(!y(b))return b}}throw new TypeError}function D(c){return!!c}function P(c){return""+c}function C(c){var d=O(c);return h(d)?d:P(d)}function B(c){return Array.isArray?Array.isArray(c):c instanceof Object?c instanceof Array:Object.prototype.toString.call(c)==="[object Array]"}function J(c){return typeof c=="function"}function ce(c){return typeof c=="function"}function Ce(c){switch(be(c)){case 3:return!0;case 4:return!0;default:return!1}}function le(c,d){return c===d||c!==c&&d!==d}function Se(c,d){var p=c[d];if(p!=null){if(!J(p))throw new TypeError;return p}}function Ge(c){var d=Se(c,s);if(!J(d))throw new TypeError;var p=d.call(c);if(!y(p))throw new TypeError;return p}function We(c){return c.value}function m(c){var d=c.next();return d.done?!1:d}function qe(c){var d=c.return;d&&d.call(c)}function He(c){var d=Object.getPrototypeOf(c);if(typeof c!="function"||c===g||d!==g)return d;var p=c.prototype,b=p&&Object.getPrototypeOf(p);if(b==null||b===Object.prototype)return d;var T=b.constructor;return typeof T!="function"||T===c?d:T}function xr(){var c;!E(z)&&typeof t.Reflect<"u"&&!(z in t.Reflect)&&typeof t.Reflect.defineMetadata=="function"&&(c=zr(t.Reflect));var d,p,b,T=new R,q={registerProvider:Y,getProvider:S,setProvider:w};return q;function Y(_){if(!Object.isExtensible(q))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case c===_:break;case E(d):d=_;break;case d===_:break;case E(p):p=_;break;case p===_:break;default:b===void 0&&(b=new x),b.add(_);break}}function I(_,j){if(!E(d)){if(d.isProviderFor(_,j))return d;if(!E(p)){if(p.isProviderFor(_,j))return d;if(!E(b))for(var N=Ge(b);;){var H=m(N);if(!H)return;var ie=We(H);if(ie.isProviderFor(_,j))return qe(N),ie}}}if(!E(c)&&c.isProviderFor(_,j))return c}function S(_,j){var N=T.get(_),H;return E(N)||(H=N.get(j)),E(H)&&(H=I(_,j),E(H)||(E(N)&&(N=new L,T.set(_,N)),N.set(j,H))),H}function A(_){if(E(_))throw new TypeError;return d===_||p===_||!E(b)&&b.has(_)}function w(_,j,N){if(!A(N))throw new Error("Metadata provider not registered.");var H=S(_,j);if(H!==N){if(!E(H))return!1;var ie=T.get(_);E(ie)&&(ie=new L,T.set(_,ie)),ie.set(j,N)}return!0}}function Ur(){var c;return!E(z)&&y(t.Reflect)&&Object.isExtensible(t.Reflect)&&(c=t.Reflect[z]),E(c)&&(c=xr()),!E(z)&&y(t.Reflect)&&Object.isExtensible(t.Reflect)&&Object.defineProperty(t.Reflect,z,{enumerable:!1,configurable:!1,writable:!1,value:c}),c}function Nr(c){var d=new R,p={isProviderFor:function(A,w){var _=d.get(A);return E(_)?!1:_.has(w)},OrdinaryDefineOwnMetadata:Y,OrdinaryHasOwnMetadata:T,OrdinaryGetOwnMetadata:q,OrdinaryOwnMetadataKeys:I,OrdinaryDeleteMetadata:S};return F.registerProvider(p),p;function b(A,w,_){var j=d.get(A),N=!1;if(E(j)){if(!_)return;j=new L,d.set(A,j),N=!0}var H=j.get(w);if(E(H)){if(!_)return;if(H=new L,j.set(w,H),!c.setProvider(A,w,p))throw j.delete(w),N&&d.delete(A),new Error("Wrong provider for target.")}return H}function T(A,w,_){var j=b(w,_,!1);return E(j)?!1:D(j.has(A))}function q(A,w,_){var j=b(w,_,!1);if(!E(j))return j.get(A)}function Y(A,w,_,j){var N=b(_,j,!0);N.set(A,w)}function I(A,w){var _=[],j=b(A,w,!1);if(E(j))return _;for(var N=j.keys(),H=Ge(N),ie=0;;){var Nt=m(H);if(!Nt)return _.length=ie,_;var qr=We(Nt);try{_[ie]=qr}catch(Hr){try{qe(H)}finally{throw Hr}}ie++}}function S(A,w,_){var j=b(w,_,!1);if(E(j)||!j.delete(A))return!1;if(j.size===0){var N=d.get(w);E(N)||(N.delete(_),N.size===0&&d.delete(N))}return!0}}function zr(c){var d=c.defineMetadata,p=c.hasOwnMetadata,b=c.getOwnMetadata,T=c.getOwnMetadataKeys,q=c.deleteMetadata,Y=new R,I={isProviderFor:function(S,A){var w=Y.get(S);return!E(w)&&w.has(A)?!0:T(S,A).length?(E(w)&&(w=new x,Y.set(S,w)),w.add(A),!0):!1},OrdinaryDefineOwnMetadata:d,OrdinaryHasOwnMetadata:p,OrdinaryGetOwnMetadata:b,OrdinaryOwnMetadataKeys:T,OrdinaryDeleteMetadata:q};return I}function Be(c,d,p){var b=F.getProvider(c,d);if(!E(b))return b;if(p){if(F.setProvider(c,d,G))return G;throw new Error("Illegal state.")}}function Vr(){var c={},d=[],p=function(){function I(S,A,w){this._index=0,this._keys=S,this._values=A,this._selector=w}return I.prototype["@@iterator"]=function(){return this},I.prototype[s]=function(){return this},I.prototype.next=function(){var S=this._index;if(S>=0&&S<this._keys.length){var A=this._selector(this._keys[S],this._values[S]);return S+1>=this._keys.length?(this._index=-1,this._keys=d,this._values=d):this._index++,{value:A,done:!1}}return{value:void 0,done:!0}},I.prototype.throw=function(S){throw this._index>=0&&(this._index=-1,this._keys=d,this._values=d),S},I.prototype.return=function(S){return this._index>=0&&(this._index=-1,this._keys=d,this._values=d),{value:S,done:!0}},I}(),b=function(){function I(){this._keys=[],this._values=[],this._cacheKey=c,this._cacheIndex=-2}return Object.defineProperty(I.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),I.prototype.has=function(S){return this._find(S,!1)>=0},I.prototype.get=function(S){var A=this._find(S,!1);return A>=0?this._values[A]:void 0},I.prototype.set=function(S,A){var w=this._find(S,!0);return this._values[w]=A,this},I.prototype.delete=function(S){var A=this._find(S,!1);if(A>=0){for(var w=this._keys.length,_=A+1;_<w;_++)this._keys[_-1]=this._keys[_],this._values[_-1]=this._values[_];return this._keys.length--,this._values.length--,le(S,this._cacheKey)&&(this._cacheKey=c,this._cacheIndex=-2),!0}return!1},I.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=c,this._cacheIndex=-2},I.prototype.keys=function(){return new p(this._keys,this._values,T)},I.prototype.values=function(){return new p(this._keys,this._values,q)},I.prototype.entries=function(){return new p(this._keys,this._values,Y)},I.prototype["@@iterator"]=function(){return this.entries()},I.prototype[s]=function(){return this.entries()},I.prototype._find=function(S,A){if(!le(this._cacheKey,S)){this._cacheIndex=-1;for(var w=0;w<this._keys.length;w++)if(le(this._keys[w],S)){this._cacheIndex=w;break}}return this._cacheIndex<0&&A&&(this._cacheIndex=this._keys.length,this._keys.push(S),this._values.push(void 0)),this._cacheIndex},I}();return b;function T(I,S){return I}function q(I,S){return S}function Y(I,S){return[I,S]}}function Gr(){var c=function(){function d(){this._map=new L}return Object.defineProperty(d.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),d.prototype.has=function(p){return this._map.has(p)},d.prototype.add=function(p){return this._map.set(p,p),this},d.prototype.delete=function(p){return this._map.delete(p)},d.prototype.clear=function(){this._map.clear()},d.prototype.keys=function(){return this._map.keys()},d.prototype.values=function(){return this._map.keys()},d.prototype.entries=function(){return this._map.entries()},d.prototype["@@iterator"]=function(){return this.keys()},d.prototype[s]=function(){return this.keys()},d}();return c}function Wr(){var c=16,d=v.create(),p=b();return function(){function S(){this._key=b()}return S.prototype.has=function(A){var w=T(A,!1);return w!==void 0?v.has(w,this._key):!1},S.prototype.get=function(A){var w=T(A,!1);return w!==void 0?v.get(w,this._key):void 0},S.prototype.set=function(A,w){var _=T(A,!0);return _[this._key]=w,this},S.prototype.delete=function(A){var w=T(A,!1);return w!==void 0?delete w[this._key]:!1},S.prototype.clear=function(){this._key=b()},S}();function b(){var S;do S="@@WeakMap@@"+I();while(v.has(d,S));return d[S]=!0,S}function T(S,A){if(!r.call(S,p)){if(!A)return;Object.defineProperty(S,p,{value:v.create()})}return S[p]}function q(S,A){for(var w=0;w<A;++w)S[w]=Math.random()*255|0;return S}function Y(S){if(typeof Uint8Array=="function"){var A=new Uint8Array(S);return typeof crypto<"u"?crypto.getRandomValues(A):typeof msCrypto<"u"?msCrypto.getRandomValues(A):q(A,S),A}return q(new Array(S),S)}function I(){var S=Y(c);S[6]=S[6]&79|64,S[8]=S[8]&191|128;for(var A="",w=0;w<c;++w){var _=S[w];(w===4||w===6||w===8)&&(A+="-"),_<16&&(A+="0"),A+=_.toString(16).toLowerCase()}return A}}function ht(c){return c.__=void 0,delete c.__,c}})})(zt||(zt={}));/*!
* metismenujs - v1.4.0
* MetisMenu: Collapsible menu plugin with Vanilla-JS
* https://github.com/onokumus/metismenujs#readme
*
* Made by Osman Nuri Okumus <onokumus@gmail.com> (https://github.com/onokumus)
* Under MIT License
*/const Jr={parentTrigger:"li",subMenu:"ul",toggle:!0,triggerElement:"a"},Je={ACTIVE:"mm-active",COLLAPSE:"mm-collapse",COLLAPSED:"mm-collapsed",COLLAPSING:"mm-collapsing",METIS:"metismenu",SHOW:"mm-show"};class nt{constructor(e,t){this.element=nt.isElement(e)?e:document.querySelector(e),this.config=Object.assign(Object.assign({},Jr),t),this.disposed=!1,this.triggerArr=[],this.boundEventHandler=this.clickEvent.bind(this),this.init()}static attach(e,t){return new nt(e,t)}init(){const{METIS:e,ACTIVE:t,COLLAPSE:r}=Je;this.element.classList.add(e);const n=[...this.element.querySelectorAll(this.config.subMenu)];n.length!==0&&n.forEach(o=>{o.classList.add(r);const s=o.closest(this.config.parentTrigger);s!=null&&s.classList.contains(t)?this.show(o):this.hide(o);const a=s==null?void 0:s.querySelector(this.config.triggerElement);(a==null?void 0:a.getAttribute("aria-disabled"))!=="true"&&(a==null||a.setAttribute("aria-expanded","false"),a==null||a.addEventListener("click",this.boundEventHandler),this.triggerArr.push(a))})}clickEvent(e){if(!this.disposed){const t=e==null?void 0:e.currentTarget;t&&t.tagName==="A"&&e.preventDefault();const r=t.closest(this.config.parentTrigger),n=r==null?void 0:r.querySelector(this.config.subMenu);this.toggle(n)}}update(){this.disposed=!1,this.init()}dispose(){this.triggerArr.forEach(e=>{e.removeEventListener("click",this.boundEventHandler)}),this.disposed=!0}on(e,t,r){return this.element.addEventListener(e,t,r),this}off(e,t,r){return this.element.removeEventListener(e,t,r),this}emit(e,t,r=!1){const n=new CustomEvent(e,{bubbles:r,detail:t});this.element.dispatchEvent(n)}toggle(e){const t=e.closest(this.config.parentTrigger);t!=null&&t.classList.contains(Je.ACTIVE)?this.hide(e):this.show(e)}show(e){var t;const r=e,{ACTIVE:n,COLLAPSE:o,COLLAPSED:s,COLLAPSING:a,SHOW:l}=Je;if(this.isTransitioning||r.classList.contains(a))return;const f=()=>{r.classList.remove(a),r.style.height="",r.removeEventListener("transitionend",f),this.setTransitioning(!1),this.emit("shown.metisMenu",{shownElement:r})},v=r.closest(this.config.parentTrigger);v==null||v.classList.add(n);const g=v==null?void 0:v.querySelector(this.config.triggerElement);g==null||g.setAttribute("aria-expanded","true"),g==null||g.classList.remove(s),r.style.height="0px",r.classList.remove(o),r.classList.remove(l),r.classList.add(a);const L=[].slice.call((t=v==null?void 0:v.parentNode)===null||t===void 0?void 0:t.children).filter(x=>x!==v);this.config.toggle&&L.length>0&&L.forEach(x=>{const R=x.querySelector(this.config.subMenu);R&&this.hide(R)}),this.setTransitioning(!0),r.classList.add(o),r.classList.add(l),r.style.height=`${r.scrollHeight}px`,this.emit("show.metisMenu",{showElement:r}),r.addEventListener("transitionend",f)}hide(e){const{ACTIVE:t,COLLAPSE:r,COLLAPSED:n,COLLAPSING:o,SHOW:s}=Je,a=e;if(this.isTransitioning||!a.classList.contains(s))return;this.emit("hide.metisMenu",{hideElement:a});const l=a.closest(this.config.parentTrigger);l==null||l.classList.remove(t);const f=()=>{a.classList.remove(o),a.classList.add(r),a.style.height="",a.removeEventListener("transitionend",f),this.setTransitioning(!1),this.emit("hidden.metisMenu",{hiddenElement:a})};a.style.height=`${a.getBoundingClientRect().height}px`,a.style.height=`${a.offsetHeight}px`,a.classList.add(o),a.classList.remove(r),a.classList.remove(s),this.setTransitioning(!0),a.addEventListener("transitionend",f),a.style.height="0px";const v=l==null?void 0:l.querySelector(this.config.triggerElement);v==null||v.setAttribute("aria-expanded","false"),v==null||v.classList.add(n)}setTransitioning(e){this.isTransitioning=e}static isElement(e){return!!e.classList}}function Vt(i){return new Promise((e,t)=>{if(document.querySelector(`link[href="${i}"]`))return e();const r=document.createElement("link");r.rel="stylesheet",r.href=i,r.onload=()=>e(),r.onerror=()=>t(new Error(`Failed to load CSS: ${i}`)),document.head.appendChild(r)})}function Yr(i){return new Promise((e,t)=>{if(document.querySelector(`script[src="${i}"]`))return e();const r=document.createElement("script");r.src=i,r.async=!0,r.onload=()=>e(),r.onerror=()=>t(new Error(`Failed to load script: ${i}`)),document.head.appendChild(r)})}class Qr{constructor(){this.instance=null}async initialize(e,t){await Vt("https://cdn.jsdelivr.net/npm/metismenujs/dist/metismenujs.min.css"),await Yr("https://cdn.jsdelivr.net/npm/metismenujs/dist/metismenujs.min.js"),await Vt(`/themes/${t}/menu-systems/metismenu.css`);const r=document.getElementById(e);if(!r)return;const n=r.querySelector("ul.cd-menu-root");if(!n)return;if(this.transformForMetisMenu(n),!document.getElementById("menu")){console.error("[MetisMenuAdapter] FATAL: Failed to find element with ID 'menu' after transformation. MetisMenu will not bind.");return}this.instance=new nt("#menu")}destroy(){}transformForMetisMenu(e){e.classList.remove("cd-menu-root"),e.classList.add("metismenu"),e.setAttribute("id","menu"),e.querySelectorAll(".cd-menu-item").forEach(t=>{const r=t.querySelector(".cd-menu-link"),n=t.querySelector(".cd-menu-label"),o=t.getAttribute("data-route")||"#",s=t.getAttribute("data-icon"),a=t.querySelector("ul");let l=null;if(s)try{const f=atob(s);l=JSON.parse(f)}catch(f){console.warn("Failed to decode or parse icon metadata",f)}if(r&&n){const f=r.querySelector(".cd-menu-toggle-icon");if(f&&f.remove(),r.innerHTML="",r.href=a?"#":`/${o}`,l){const g=this.createIconElement(l);g&&(g.classList.add("menu-icon"),r.appendChild(g))}const v=document.createElement("span");if(v.classList.add("cd-menu-label"),v.textContent=n.textContent||"",r.appendChild(v),a){r.classList.add("has-arrow"),r.setAttribute("aria-expanded","false");const g=document.createElement("i");g.classList.add("menu-arrow","fa-solid","fa-chevron-right"),r.appendChild(g)}}t.classList.remove("cd-menu-item")}),e.querySelectorAll("ul.cd-submenu").forEach(t=>{t.classList.remove("cd-submenu")})}createIconElement(e){if(!e.iconType)return null;const t=this.getCurrentThemeMenu(),r=(t==null?void 0:t.iconSize)??14,n=(t==null?void 0:t.iconColor)??"#444";switch(e.iconType){case"fontawesome":{const o=document.createElement("i");return o.className=e.icon,o.style.color=n,o.style.fontSize=`${r}px`,o}case"svg":{const o=document.createElement("span");o.innerHTML=e.icon;const s=o.firstElementChild;return s&&(s.style.color=n,s.style.width=`${r}px`,s.style.height=`${r}px`),s}case"string":{const o=document.createElement("span");return o.textContent=e.icon,o.style.color=n,o.style.fontSize=`${r}px`,o}default:return null}}getCurrentThemeMenu(){var e,t;try{const r=localStorage.getItem("cd-theme"),n=r?JSON.parse(r):null;return(t=(e=n==null?void 0:n.layout)==null?void 0:e.sidebar)==null?void 0:t.menu}catch{return}}}class $e{constructor(){this.cache={}}static getInstance(){return console.log("[ControllerCacheService][getInstance] start..."),$e.instance||($e.instance=new $e),$e.instance}async getOrInitializeController(e,t){if(console.log("[ControllerCacheService][getOrInitializeController] start..."),this.cache[e])return console.log(`[ControllerCacheService] Using cached controller: ${e}`),this.cache[e];if(console.log(`[ControllerCacheService] Creating new instance for: ${e}`),!t||typeof t!="object")return console.error(`[ControllerCacheService] Invalid controllerDef for '${e}'.`,t),null;let r;try{r=Object.create(t)}catch(n){return console.error(`[ControllerCacheService] Failed to create instance for '${e}'.`,n),null}for(const n of Object.keys(t)){const o=Object.getOwnPropertyDescriptor(t,n);o&&o.value!==void 0&&typeof o.value!="function"&&(r[n]=o.value)}try{typeof r.__init=="function"&&r.__init(),typeof r.__setup=="function"&&await r.__setup()}catch(n){console.error(`[ControllerCacheService] Initialization failed for '${e}'.`,n)}return this.cache[e]=r,console.log(`[ControllerCacheService] Cached instance for ${e}`),r}forceReinit(e){console.log(`[ControllerCacheService] Force reinit for: ${e}`);const t=this.cache[e];t&&typeof t.__init=="function"&&t.__init()}}var Lt={},fr={},pr=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},t=Symbol("test"),r=Object(t);if(typeof t=="string"||Object.prototype.toString.call(t)!=="[object Symbol]"||Object.prototype.toString.call(r)!=="[object Symbol]")return!1;var n=42;e[t]=n;for(var o in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var s=Object.getOwnPropertySymbols(e);if(s.length!==1||s[0]!==t||!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(e,t);if(a.value!==n||a.enumerable!==!0)return!1}return!0},Zr=pr,dt=function(){return Zr()&&!!Symbol.toStringTag},hr=Object,Xr=Error,Kr=EvalError,en=RangeError,tn=ReferenceError,yr=SyntaxError,xe=TypeError,rn=URIError,nn=Math.abs,on=Math.floor,an=Math.max,sn=Math.min,cn=Math.pow,ln=Math.round,un=Number.isNaN||function(e){return e!==e},dn=un,fn=function(e){return dn(e)||e===0?e:e<0?-1:1},pn=Object.getOwnPropertyDescriptor,Qe=pn;if(Qe)try{Qe([],"length")}catch{Qe=null}var Re=Qe,Ze=Object.defineProperty||!1;if(Ze)try{Ze({},"a",{value:1})}catch{Ze=!1}var ft=Ze,yt,Gt;function hn(){if(Gt)return yt;Gt=1;var i=typeof Symbol<"u"&&Symbol,e=pr;return yt=function(){return typeof i!="function"||typeof Symbol!="function"||typeof i("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},yt}var mr=typeof Reflect<"u"&&Reflect.getPrototypeOf||null,yn=hr,gr=yn.getPrototypeOf||null,mn="Function.prototype.bind called on incompatible ",gn=Object.prototype.toString,vn=Math.max,bn="[object Function]",Wt=function(e,t){for(var r=[],n=0;n<e.length;n+=1)r[n]=e[n];for(var o=0;o<t.length;o+=1)r[o+e.length]=t[o];return r},Sn=function(e,t){for(var r=[],n=t,o=0;n<e.length;n+=1,o+=1)r[o]=e[n];return r},An=function(i,e){for(var t="",r=0;r<i.length;r+=1)t+=i[r],r+1<i.length&&(t+=e);return t},wn=function(e){var t=this;if(typeof t!="function"||gn.apply(t)!==bn)throw new TypeError(mn+t);for(var r=Sn(arguments,1),n,o=function(){if(this instanceof n){var v=t.apply(this,Wt(r,arguments));return Object(v)===v?v:this}return t.apply(e,Wt(r,arguments))},s=vn(0,t.length-r.length),a=[],l=0;l<s;l++)a[l]="$"+l;if(n=Function("binder","return function ("+An(a,",")+"){ return binder.apply(this,arguments); }")(o),t.prototype){var f=function(){};f.prototype=t.prototype,n.prototype=new f,f.prototype=null}return n},_n=wn,Ue=Function.prototype.bind||_n,kt=Function.prototype.call,Dt=Function.prototype.apply,Mn=typeof Reflect<"u"&&Reflect&&Reflect.apply,En=Ue,Tn=Dt,Cn=kt,On=Mn,vr=On||En.call(Cn,Tn),Pn=Ue,In=xe,$n=kt,jn=vr,Rt=function(e){if(e.length<1||typeof e[0]!="function")throw new In("a function is required");return jn(Pn,$n,e)},Ln=Rt,qt=Re,br;try{br=[].__proto__===Array.prototype}catch(i){if(!i||typeof i!="object"||!("code"in i)||i.code!=="ERR_PROTO_ACCESS")throw i}var mt=!!br&&qt&&qt(Object.prototype,"__proto__"),Sr=Object,Ht=Sr.getPrototypeOf,kn=mt&&typeof mt.get=="function"?Ln([mt.get]):typeof Ht=="function"?function(e){return Ht(e==null?e:Sr(e))}:!1,Jt=mr,Yt=gr,Qt=kn,Bt=Jt?function(e){return Jt(e)}:Yt?function(e){if(!e||typeof e!="object"&&typeof e!="function")throw new TypeError("getProto: not an object");return Yt(e)}:Qt?function(e){return Qt(e)}:null,Dn=Function.prototype.call,Rn=Object.prototype.hasOwnProperty,Bn=Ue,Ar=Bn.call(Dn,Rn),$,Fn=hr,xn=Xr,Un=Kr,Nn=en,zn=tn,De=yr,Le=xe,Vn=rn,Gn=nn,Wn=on,qn=an,Hn=sn,Jn=cn,Yn=ln,Qn=fn,wr=Function,gt=function(i){try{return wr('"use strict"; return ('+i+").constructor;")()}catch{}},Fe=Re,Zn=ft,vt=function(){throw new Le},Xn=Fe?function(){try{return arguments.callee,vt}catch{try{return Fe(arguments,"callee").get}catch{return vt}}}():vt,Oe=hn()(),Q=Bt,Kn=gr,eo=mr,_r=Dt,Ne=kt,Ie={},to=typeof Uint8Array>"u"||!Q?$:Q(Uint8Array),Ee={__proto__:null,"%AggregateError%":typeof AggregateError>"u"?$:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?$:ArrayBuffer,"%ArrayIteratorPrototype%":Oe&&Q?Q([][Symbol.iterator]()):$,"%AsyncFromSyncIteratorPrototype%":$,"%AsyncFunction%":Ie,"%AsyncGenerator%":Ie,"%AsyncGeneratorFunction%":Ie,"%AsyncIteratorPrototype%":Ie,"%Atomics%":typeof Atomics>"u"?$:Atomics,"%BigInt%":typeof BigInt>"u"?$:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?$:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?$:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?$:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":xn,"%eval%":eval,"%EvalError%":Un,"%Float16Array%":typeof Float16Array>"u"?$:Float16Array,"%Float32Array%":typeof Float32Array>"u"?$:Float32Array,"%Float64Array%":typeof Float64Array>"u"?$:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?$:FinalizationRegistry,"%Function%":wr,"%GeneratorFunction%":Ie,"%Int8Array%":typeof Int8Array>"u"?$:Int8Array,"%Int16Array%":typeof Int16Array>"u"?$:Int16Array,"%Int32Array%":typeof Int32Array>"u"?$:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Oe&&Q?Q(Q([][Symbol.iterator]())):$,"%JSON%":typeof JSON=="object"?JSON:$,"%Map%":typeof Map>"u"?$:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Oe||!Q?$:Q(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Fn,"%Object.getOwnPropertyDescriptor%":Fe,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?$:Promise,"%Proxy%":typeof Proxy>"u"?$:Proxy,"%RangeError%":Nn,"%ReferenceError%":zn,"%Reflect%":typeof Reflect>"u"?$:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?$:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Oe||!Q?$:Q(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?$:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Oe&&Q?Q(""[Symbol.iterator]()):$,"%Symbol%":Oe?Symbol:$,"%SyntaxError%":De,"%ThrowTypeError%":Xn,"%TypedArray%":to,"%TypeError%":Le,"%Uint8Array%":typeof Uint8Array>"u"?$:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?$:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?$:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?$:Uint32Array,"%URIError%":Vn,"%WeakMap%":typeof WeakMap>"u"?$:WeakMap,"%WeakRef%":typeof WeakRef>"u"?$:WeakRef,"%WeakSet%":typeof WeakSet>"u"?$:WeakSet,"%Function.prototype.call%":Ne,"%Function.prototype.apply%":_r,"%Object.defineProperty%":Zn,"%Object.getPrototypeOf%":Kn,"%Math.abs%":Gn,"%Math.floor%":Wn,"%Math.max%":qn,"%Math.min%":Hn,"%Math.pow%":Jn,"%Math.round%":Yn,"%Math.sign%":Qn,"%Reflect.getPrototypeOf%":eo};if(Q)try{null.error}catch(i){var ro=Q(Q(i));Ee["%Error.prototype%"]=ro}var no=function i(e){var t;if(e==="%AsyncFunction%")t=gt("async function () {}");else if(e==="%GeneratorFunction%")t=gt("function* () {}");else if(e==="%AsyncGeneratorFunction%")t=gt("async function* () {}");else if(e==="%AsyncGenerator%"){var r=i("%AsyncGeneratorFunction%");r&&(t=r.prototype)}else if(e==="%AsyncIteratorPrototype%"){var n=i("%AsyncGenerator%");n&&Q&&(t=Q(n.prototype))}return Ee[e]=t,t},Zt={__proto__:null,"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ze=Ue,ot=Ar,oo=ze.call(Ne,Array.prototype.concat),io=ze.call(_r,Array.prototype.splice),Xt=ze.call(Ne,String.prototype.replace),it=ze.call(Ne,String.prototype.slice),ao=ze.call(Ne,RegExp.prototype.exec),so=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,co=/\\(\\)?/g,lo=function(e){var t=it(e,0,1),r=it(e,-1);if(t==="%"&&r!=="%")throw new De("invalid intrinsic syntax, expected closing `%`");if(r==="%"&&t!=="%")throw new De("invalid intrinsic syntax, expected opening `%`");var n=[];return Xt(e,so,function(o,s,a,l){n[n.length]=a?Xt(l,co,"$1"):s||o}),n},uo=function(e,t){var r=e,n;if(ot(Zt,r)&&(n=Zt[r],r="%"+n[0]+"%"),ot(Ee,r)){var o=Ee[r];if(o===Ie&&(o=no(r)),typeof o>"u"&&!t)throw new Le("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:r,value:o}}throw new De("intrinsic "+e+" does not exist!")},Mr=function(e,t){if(typeof e!="string"||e.length===0)throw new Le("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof t!="boolean")throw new Le('"allowMissing" argument must be a boolean');if(ao(/^%?[^%]*%?$/,e)===null)throw new De("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var r=lo(e),n=r.length>0?r[0]:"",o=uo("%"+n+"%",t),s=o.name,a=o.value,l=!1,f=o.alias;f&&(n=f[0],io(r,oo([0,1],f)));for(var v=1,g=!0;v<r.length;v+=1){var L=r[v],x=it(L,0,1),R=it(L,-1);if((x==='"'||x==="'"||x==="`"||R==='"'||R==="'"||R==="`")&&x!==R)throw new De("property names with quotes must have matching quotes");if((L==="constructor"||!g)&&(l=!0),n+="."+L,s="%"+n+"%",ot(Ee,s))a=Ee[s];else if(a!=null){if(!(L in a)){if(!t)throw new Le("base intrinsic for "+e+" exists, but the property is not available.");return}if(Fe&&v+1>=r.length){var z=Fe(a,L);g=!!z,g&&"get"in z&&!("originalValue"in z.get)?a=z.get:a=a[L]}else g=ot(a,L),a=a[L];g&&!l&&(Ee[s]=a)}}return a},Er=Mr,Tr=Rt,fo=Tr([Er("%String.prototype.indexOf%")]),Ve=function(e,t){var r=Er(e,!!t);return typeof r=="function"&&fo(e,".prototype.")>-1?Tr([r]):r},po=dt(),ho=Ve,Mt=ho("Object.prototype.toString"),pt=function(e){return po&&e&&typeof e=="object"&&Symbol.toStringTag in e?!1:Mt(e)==="[object Arguments]"},Cr=function(e){return pt(e)?!0:e!==null&&typeof e=="object"&&"length"in e&&typeof e.length=="number"&&e.length>=0&&Mt(e)!=="[object Array]"&&"callee"in e&&Mt(e.callee)==="[object Function]"},yo=function(){return pt(arguments)}();pt.isLegacyArguments=Cr;var mo=yo?pt:Cr,Kt=Ve,go=dt(),vo=Ar,bo=Re,Et;if(go){var So=Kt("RegExp.prototype.exec"),er={},bt=function(){throw er},tr={toString:bt,valueOf:bt};typeof Symbol.toPrimitive=="symbol"&&(tr[Symbol.toPrimitive]=bt),Et=function(e){if(!e||typeof e!="object")return!1;var t=bo(e,"lastIndex"),r=t&&vo(t,"value");if(!r)return!1;try{So(e,tr)}catch(n){return n===er}}}else{var Ao=Kt("Object.prototype.toString"),wo="[object RegExp]";Et=function(e){return!e||typeof e!="object"&&typeof e!="function"?!1:Ao(e)===wo}}var _o=Et,Mo=Ve,Eo=_o,To=Mo("RegExp.prototype.exec"),Co=xe,Oo=function(e){if(!Eo(e))throw new Co("`regex` must be a RegExp");return function(r){return To(e,r)!==null}},St,rr;function Po(){if(rr)return St;rr=1;const i=(function*(){}).constructor;return St=()=>i,St}var Or=Ve,Io=Oo,$o=Io(/^\s*(?:function)?\*/),jo=dt(),nr=Bt,Lo=Or("Object.prototype.toString"),ko=Or("Function.prototype.toString"),Do=Po(),Ro=function(e){if(typeof e!="function")return!1;if($o(ko(e)))return!0;if(!jo){var t=Lo(e);return t==="[object GeneratorFunction]"}if(!nr)return!1;var r=Do();return r&&nr(e)===r.prototype},Pr=Function.prototype.toString,je=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,Tt,Xe;if(typeof je=="function"&&typeof Object.defineProperty=="function")try{Tt=Object.defineProperty({},"length",{get:function(){throw Xe}}),Xe={},je(function(){throw 42},null,Tt)}catch(i){i!==Xe&&(je=null)}else je=null;var Bo=/^\s*class\b/,Ct=function(e){try{var t=Pr.call(e);return Bo.test(t)}catch{return!1}},At=function(e){try{return Ct(e)?!1:(Pr.call(e),!0)}catch{return!1}},Ke=Object.prototype.toString,Fo="[object Object]",xo="[object Function]",Uo="[object GeneratorFunction]",No="[object HTMLAllCollection]",zo="[object HTML document.all class]",Vo="[object HTMLCollection]",Go=typeof Symbol=="function"&&!!Symbol.toStringTag,Wo=!(0 in[,]),Ot=function(){return!1};if(typeof document=="object"){var qo=document.all;Ke.call(qo)===Ke.call(document.all)&&(Ot=function(e){if((Wo||!e)&&(typeof e>"u"||typeof e=="object"))try{var t=Ke.call(e);return(t===No||t===zo||t===Vo||t===Fo)&&e("")==null}catch{}return!1})}var Ho=je?function(e){if(Ot(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;try{je(e,null,Tt)}catch(t){if(t!==Xe)return!1}return!Ct(e)&&At(e)}:function(e){if(Ot(e))return!0;if(!e||typeof e!="function"&&typeof e!="object")return!1;if(Go)return At(e);if(Ct(e))return!1;var t=Ke.call(e);return t!==xo&&t!==Uo&&!/^\[object HTML/.test(t)?!1:At(e)},Jo=Ho,Yo=Object.prototype.toString,Ir=Object.prototype.hasOwnProperty,Qo=function(e,t,r){for(var n=0,o=e.length;n<o;n++)Ir.call(e,n)&&(r==null?t(e[n],n,e):t.call(r,e[n],n,e))},Zo=function(e,t,r){for(var n=0,o=e.length;n<o;n++)r==null?t(e.charAt(n),n,e):t.call(r,e.charAt(n),n,e)},Xo=function(e,t,r){for(var n in e)Ir.call(e,n)&&(r==null?t(e[n],n,e):t.call(r,e[n],n,e))};function Ko(i){return Yo.call(i)==="[object Array]"}var ei=function(e,t,r){if(!Jo(t))throw new TypeError("iterator must be a function");var n;arguments.length>=3&&(n=r),Ko(e)?Qo(e,t,n):typeof e=="string"?Zo(e,t,n):Xo(e,t,n)},ti=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],wt=ti,ri=typeof globalThis>"u"?rt:globalThis,ni=function(){for(var e=[],t=0;t<wt.length;t++)typeof ri[wt[t]]=="function"&&(e[e.length]=wt[t]);return e},$r={exports:{}},or=ft,oi=yr,Pe=xe,ir=Re,ii=function(e,t,r){if(!e||typeof e!="object"&&typeof e!="function")throw new Pe("`obj` must be an object or a function`");if(typeof t!="string"&&typeof t!="symbol")throw new Pe("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new Pe("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new Pe("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new Pe("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Pe("`loose`, if provided, must be a boolean");var n=arguments.length>3?arguments[3]:null,o=arguments.length>4?arguments[4]:null,s=arguments.length>5?arguments[5]:null,a=arguments.length>6?arguments[6]:!1,l=!!ir&&ir(e,t);if(or)or(e,t,{configurable:s===null&&l?l.configurable:!s,enumerable:n===null&&l?l.enumerable:!n,value:r,writable:o===null&&l?l.writable:!o});else if(a||!n&&!o&&!s)e[t]=r;else throw new oi("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Pt=ft,jr=function(){return!!Pt};jr.hasArrayLengthDefineBug=function(){if(!Pt)return null;try{return Pt([],"length",{value:1}).length!==1}catch{return!0}};var ai=jr,si=Mr,ar=ii,ci=ai(),sr=Re,cr=xe,li=si("%Math.floor%"),ui=function(e,t){if(typeof e!="function")throw new cr("`fn` is not a function");if(typeof t!="number"||t<0||t>4294967295||li(t)!==t)throw new cr("`length` must be a positive 32-bit integer");var r=arguments.length>2&&!!arguments[2],n=!0,o=!0;if("length"in e&&sr){var s=sr(e,"length");s&&!s.configurable&&(n=!1),s&&!s.writable&&(o=!1)}return(n||o||!r)&&(ci?ar(e,"length",t,!0,!0):ar(e,"length",t)),e},di=Ue,fi=Dt,pi=vr,hi=function(){return pi(di,fi,arguments)};(function(i){var e=ui,t=ft,r=Rt,n=hi;i.exports=function(s){var a=r(arguments),l=s.length-(arguments.length-1);return e(a,1+(l>0?l:0),!0)},t?t(i.exports,"apply",{value:n}):i.exports.apply=n})($r);var yi=$r.exports,at=ei,mi=ni,lr=yi,Ft=Ve,et=Re,Ye=Bt,gi=Ft("Object.prototype.toString"),Lr=dt(),ur=typeof globalThis>"u"?rt:globalThis,It=mi(),xt=Ft("String.prototype.slice"),vi=Ft("Array.prototype.indexOf",!0)||function(e,t){for(var r=0;r<e.length;r+=1)if(e[r]===t)return r;return-1},st={__proto__:null};Lr&&et&&Ye?at(It,function(i){var e=new ur[i];if(Symbol.toStringTag in e&&Ye){var t=Ye(e),r=et(t,Symbol.toStringTag);if(!r&&t){var n=Ye(t);r=et(n,Symbol.toStringTag)}st["$"+i]=lr(r.get)}}):at(It,function(i){var e=new ur[i],t=e.slice||e.set;t&&(st["$"+i]=lr(t))});var bi=function(e){var t=!1;return at(st,function(r,n){if(!t)try{"$"+r(e)===n&&(t=xt(n,1))}catch{}}),t},Si=function(e){var t=!1;return at(st,function(r,n){if(!t)try{r(e),t=xt(n,1)}catch{}}),t},kr=function(e){if(!e||typeof e!="object")return!1;if(!Lr){var t=xt(gi(e),8,-1);return vi(It,t)>-1?t:t!=="Object"?!1:Si(e)}return et?bi(e):null},Ai=kr,wi=function(e){return!!Ai(e)};(function(i){var e=mo,t=Ro,r=kr,n=wi;function o(m){return m.call.bind(m)}var s=typeof BigInt<"u",a=typeof Symbol<"u",l=o(Object.prototype.toString),f=o(Number.prototype.valueOf),v=o(String.prototype.valueOf),g=o(Boolean.prototype.valueOf);if(s)var L=o(BigInt.prototype.valueOf);if(a)var x=o(Symbol.prototype.valueOf);function R(m,qe){if(typeof m!="object")return!1;try{return qe(m),!0}catch{return!1}}i.isArgumentsObject=e,i.isGeneratorFunction=t,i.isTypedArray=n;function z(m){return typeof Promise<"u"&&m instanceof Promise||m!==null&&typeof m=="object"&&typeof m.then=="function"&&typeof m.catch=="function"}i.isPromise=z;function F(m){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(m):n(m)||u(m)}i.isArrayBufferView=F;function G(m){return r(m)==="Uint8Array"}i.isUint8Array=G;function V(m){return r(m)==="Uint8ClampedArray"}i.isUint8ClampedArray=V;function U(m){return r(m)==="Uint16Array"}i.isUint16Array=U;function K(m){return r(m)==="Uint32Array"}i.isUint32Array=K;function Z(m){return r(m)==="Int8Array"}i.isInt8Array=Z;function re(m){return r(m)==="Int16Array"}i.isInt16Array=re;function ue(m){return r(m)==="Int32Array"}i.isInt32Array=ue;function ne(m){return r(m)==="Float32Array"}i.isFloat32Array=ne;function de(m){return r(m)==="Float64Array"}i.isFloat64Array=de;function se(m){return r(m)==="BigInt64Array"}i.isBigInt64Array=se;function ye(m){return r(m)==="BigUint64Array"}i.isBigUint64Array=ye;function te(m){return l(m)==="[object Map]"}te.working=typeof Map<"u"&&te(new Map);function me(m){return typeof Map>"u"?!1:te.working?te(m):m instanceof Map}i.isMap=me;function fe(m){return l(m)==="[object Set]"}fe.working=typeof Set<"u"&&fe(new Set);function pe(m){return typeof Set>"u"?!1:fe.working?fe(m):m instanceof Set}i.isSet=pe;function oe(m){return l(m)==="[object WeakMap]"}oe.working=typeof WeakMap<"u"&&oe(new WeakMap);function Te(m){return typeof WeakMap>"u"?!1:oe.working?oe(m):m instanceof WeakMap}i.isWeakMap=Te;function ge(m){return l(m)==="[object WeakSet]"}ge.working=typeof WeakSet<"u"&&ge(new WeakSet);function ve(m){return ge(m)}i.isWeakSet=ve;function X(m){return l(m)==="[object ArrayBuffer]"}X.working=typeof ArrayBuffer<"u"&&X(new ArrayBuffer);function be(m){return typeof ArrayBuffer>"u"?!1:X.working?X(m):m instanceof ArrayBuffer}i.isArrayBuffer=be;function E(m){return l(m)==="[object DataView]"}E.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&E(new DataView(new ArrayBuffer(1),0,1));function u(m){return typeof DataView>"u"?!1:E.working?E(m):m instanceof DataView}i.isDataView=u;var h=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function y(m){return l(m)==="[object SharedArrayBuffer]"}function O(m){return typeof h>"u"?!1:(typeof y.working>"u"&&(y.working=y(new h)),y.working?y(m):m instanceof h)}i.isSharedArrayBuffer=O;function k(m){return l(m)==="[object AsyncFunction]"}i.isAsyncFunction=k;function D(m){return l(m)==="[object Map Iterator]"}i.isMapIterator=D;function P(m){return l(m)==="[object Set Iterator]"}i.isSetIterator=P;function C(m){return l(m)==="[object Generator]"}i.isGeneratorObject=C;function B(m){return l(m)==="[object WebAssembly.Module]"}i.isWebAssemblyCompiledModule=B;function J(m){return R(m,f)}i.isNumberObject=J;function ce(m){return R(m,v)}i.isStringObject=ce;function Ce(m){return R(m,g)}i.isBooleanObject=Ce;function le(m){return s&&R(m,L)}i.isBigIntObject=le;function Se(m){return a&&R(m,x)}i.isSymbolObject=Se;function Ge(m){return J(m)||ce(m)||Ce(m)||le(m)||Se(m)}i.isBoxedPrimitive=Ge;function We(m){return typeof Uint8Array<"u"&&(be(m)||O(m))}i.isAnyArrayBuffer=We,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(m){Object.defineProperty(i,m,{enumerable:!1,value:function(){throw new Error(m+" is not supported in userland")}})})})(fr);var _i=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"},$t={exports:{}};typeof Object.create=="function"?$t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:$t.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}};var Mi=$t.exports;(function(i){var e={},t=Object.getOwnPropertyDescriptors||function(h){for(var y=Object.keys(h),O={},k=0;k<y.length;k++)O[y[k]]=Object.getOwnPropertyDescriptor(h,y[k]);return O},r=/%[sdj%]/g;i.format=function(u){if(!re(u)){for(var h=[],y=0;y<arguments.length;y++)h.push(a(arguments[y]));return h.join(" ")}for(var y=1,O=arguments,k=O.length,D=String(u).replace(r,function(C){if(C==="%%")return"%";if(y>=k)return C;switch(C){case"%s":return String(O[y++]);case"%d":return Number(O[y++]);case"%j":try{return JSON.stringify(O[y++])}catch{return"[Circular]"}default:return C}}),P=O[y];y<k;P=O[++y])U(P)||!se(P)?D+=" "+P:D+=" "+a(P);return D},i.deprecate=function(u,h){if(typeof process<"u"&&process.noDeprecation===!0)return u;if(typeof process>"u")return function(){return i.deprecate(u,h).apply(this,arguments)};var y=!1;function O(){if(!y){if(process.throwDeprecation)throw new Error(h);process.traceDeprecation?console.trace(h):console.error(h),y=!0}return u.apply(this,arguments)}return O};var n={},o=/^$/;if(e.NODE_DEBUG){var s=e.NODE_DEBUG;s=s.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),o=new RegExp("^"+s+"$","i")}i.debuglog=function(u){if(u=u.toUpperCase(),!n[u])if(o.test(u)){var h=process.pid;n[u]=function(){var y=i.format.apply(i,arguments);console.error("%s %d: %s",u,h,y)}}else n[u]=function(){};return n[u]};function a(u,h){var y={seen:[],stylize:f};return arguments.length>=3&&(y.depth=arguments[2]),arguments.length>=4&&(y.colors=arguments[3]),V(h)?y.showHidden=h:h&&i._extend(y,h),ne(y.showHidden)&&(y.showHidden=!1),ne(y.depth)&&(y.depth=2),ne(y.colors)&&(y.colors=!1),ne(y.customInspect)&&(y.customInspect=!0),y.colors&&(y.stylize=l),g(y,u,y.depth)}i.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function l(u,h){var y=a.styles[h];return y?"\x1B["+a.colors[y][0]+"m"+u+"\x1B["+a.colors[y][1]+"m":u}function f(u,h){return u}function v(u){var h={};return u.forEach(function(y,O){h[y]=!0}),h}function g(u,h,y){if(u.customInspect&&h&&me(h.inspect)&&h.inspect!==i.inspect&&!(h.constructor&&h.constructor.prototype===h)){var O=h.inspect(y,u);return re(O)||(O=g(u,O,y)),O}var k=L(u,h);if(k)return k;var D=Object.keys(h),P=v(D);if(u.showHidden&&(D=Object.getOwnPropertyNames(h)),te(h)&&(D.indexOf("message")>=0||D.indexOf("description")>=0))return x(h);if(D.length===0){if(me(h)){var C=h.name?": "+h.name:"";return u.stylize("[Function"+C+"]","special")}if(de(h))return u.stylize(RegExp.prototype.toString.call(h),"regexp");if(ye(h))return u.stylize(Date.prototype.toString.call(h),"date");if(te(h))return x(h)}var B="",J=!1,ce=["{","}"];if(G(h)&&(J=!0,ce=["[","]"]),me(h)){var Ce=h.name?": "+h.name:"";B=" [Function"+Ce+"]"}if(de(h)&&(B=" "+RegExp.prototype.toString.call(h)),ye(h)&&(B=" "+Date.prototype.toUTCString.call(h)),te(h)&&(B=" "+x(h)),D.length===0&&(!J||h.length==0))return ce[0]+B+ce[1];if(y<0)return de(h)?u.stylize(RegExp.prototype.toString.call(h),"regexp"):u.stylize("[Object]","special");u.seen.push(h);var le;return J?le=R(u,h,y,P,D):le=D.map(function(Se){return z(u,h,y,P,Se,J)}),u.seen.pop(),F(le,B,ce)}function L(u,h){if(ne(h))return u.stylize("undefined","undefined");if(re(h)){var y="'"+JSON.stringify(h).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return u.stylize(y,"string")}if(Z(h))return u.stylize(""+h,"number");if(V(h))return u.stylize(""+h,"boolean");if(U(h))return u.stylize("null","null")}function x(u){return"["+Error.prototype.toString.call(u)+"]"}function R(u,h,y,O,k){for(var D=[],P=0,C=h.length;P<C;++P)ve(h,String(P))?D.push(z(u,h,y,O,String(P),!0)):D.push("");return k.forEach(function(B){B.match(/^\d+$/)||D.push(z(u,h,y,O,B,!0))}),D}function z(u,h,y,O,k,D){var P,C,B;if(B=Object.getOwnPropertyDescriptor(h,k)||{value:h[k]},B.get?B.set?C=u.stylize("[Getter/Setter]","special"):C=u.stylize("[Getter]","special"):B.set&&(C=u.stylize("[Setter]","special")),ve(O,k)||(P="["+k+"]"),C||(u.seen.indexOf(B.value)<0?(U(y)?C=g(u,B.value,null):C=g(u,B.value,y-1),C.indexOf(`
`)>-1&&(D?C=C.split(`
`).map(function(J){return"  "+J}).join(`
`).slice(2):C=`
`+C.split(`
`).map(function(J){return"   "+J}).join(`
`))):C=u.stylize("[Circular]","special")),ne(P)){if(D&&k.match(/^\d+$/))return C;P=JSON.stringify(""+k),P.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(P=P.slice(1,-1),P=u.stylize(P,"name")):(P=P.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),P=u.stylize(P,"string"))}return P+": "+C}function F(u,h,y){var O=u.reduce(function(k,D){return D.indexOf(`
`)>=0,k+D.replace(/\u001b\[\d\d?m/g,"").length+1},0);return O>60?y[0]+(h===""?"":h+`
 `)+" "+u.join(`,
  `)+" "+y[1]:y[0]+h+" "+u.join(", ")+" "+y[1]}i.types=fr;function G(u){return Array.isArray(u)}i.isArray=G;function V(u){return typeof u=="boolean"}i.isBoolean=V;function U(u){return u===null}i.isNull=U;function K(u){return u==null}i.isNullOrUndefined=K;function Z(u){return typeof u=="number"}i.isNumber=Z;function re(u){return typeof u=="string"}i.isString=re;function ue(u){return typeof u=="symbol"}i.isSymbol=ue;function ne(u){return u===void 0}i.isUndefined=ne;function de(u){return se(u)&&pe(u)==="[object RegExp]"}i.isRegExp=de,i.types.isRegExp=de;function se(u){return typeof u=="object"&&u!==null}i.isObject=se;function ye(u){return se(u)&&pe(u)==="[object Date]"}i.isDate=ye,i.types.isDate=ye;function te(u){return se(u)&&(pe(u)==="[object Error]"||u instanceof Error)}i.isError=te,i.types.isNativeError=te;function me(u){return typeof u=="function"}i.isFunction=me;function fe(u){return u===null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||typeof u=="symbol"||typeof u>"u"}i.isPrimitive=fe,i.isBuffer=_i;function pe(u){return Object.prototype.toString.call(u)}function oe(u){return u<10?"0"+u.toString(10):u.toString(10)}var Te=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ge(){var u=new Date,h=[oe(u.getHours()),oe(u.getMinutes()),oe(u.getSeconds())].join(":");return[u.getDate(),Te[u.getMonth()],h].join(" ")}i.log=function(){console.log("%s - %s",ge(),i.format.apply(i,arguments))},i.inherits=Mi,i._extend=function(u,h){if(!h||!se(h))return u;for(var y=Object.keys(h),O=y.length;O--;)u[y[O]]=h[y[O]];return u};function ve(u,h){return Object.prototype.hasOwnProperty.call(u,h)}var X=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;i.promisify=function(h){if(typeof h!="function")throw new TypeError('The "original" argument must be of type Function');if(X&&h[X]){var y=h[X];if(typeof y!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(y,X,{value:y,enumerable:!1,writable:!1,configurable:!0}),y}function y(){for(var O,k,D=new Promise(function(B,J){O=B,k=J}),P=[],C=0;C<arguments.length;C++)P.push(arguments[C]);P.push(function(B,J){B?k(B):O(J)});try{h.apply(this,P)}catch(B){k(B)}return D}return Object.setPrototypeOf(y,Object.getPrototypeOf(h)),X&&Object.defineProperty(y,X,{value:y,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(y,t(h))},i.promisify.custom=X;function be(u,h){if(!u){var y=new Error("Promise was rejected with a falsy value");y.reason=u,u=y}return h(u)}function E(u){if(typeof u!="function")throw new TypeError('The "original" argument must be of type Function');function h(){for(var y=[],O=0;O<arguments.length;O++)y.push(arguments[O]);var k=y.pop();if(typeof k!="function")throw new TypeError("The last argument must be of type Function");var D=this,P=function(){return k.apply(D,arguments)};u.apply(this,y).then(function(C){process.nextTick(P.bind(null,null,C))},function(C){process.nextTick(be.bind(null,C,P))})}return Object.setPrototypeOf(h,Object.getPrototypeOf(u)),Object.defineProperties(h,t(u)),h}i.callbackify=E})(Lt);class Ei{constructor(){this.currentAdapter=null,this._activeController=null,this.activeController=null}renderMenuWithSystem(e,t,r="cd-sidebar"){var s,a,l,f;console.debug("Starting renderMenuWithSystem()"),console.debug("renderMenuWithSystem()/01"),this.renderPlainMenu(e,r);const n=((l=(a=(s=t==null?void 0:t.layout)==null?void 0:s.sidebar)==null?void 0:a.menu)==null?void 0:l.menuSystem)||"plain",o=this.menuAdapterFactory(n);console.debug("renderMenuWithSystem()/adapter:",JSON.stringify(o)),(f=this.currentAdapter)!=null&&f.destroy&&(console.debug("renderMenuWithSystem()/02"),this.currentAdapter.destroy()),o&&(console.debug("renderMenuWithSystem()/03"),o.initialize(r,t.id),this.currentAdapter=o),console.debug("renderMenuWithSystem()/04")}renderPlainMenu(e,t="sidebar",r){const n=document.getElementById(t);n&&(console.log("MenuService::renderPlainMenu()/menu:",this.renderMenuHtml(e)),n.innerHTML=`<ul class="cd-menu-root">${this.renderMenuHtml(e)}</ul>`,this.attachClickHandlers(n,e,r))}attachClickHandlers(e,t,r){e.querySelectorAll(".cd-menu-link").forEach(o=>{o.addEventListener("click",s=>{s.preventDefault(),s.stopPropagation();const a=o.getAttribute("data-id");if(!a)return;const l=this.findMenuItemById(t,a);l&&this.onMenuClick(l,r)})})}findMenuItemById(e,t){for(const r of e){if(r.menuId===t)return r;if(r.children){const n=this.findMenuItemById(r.children,t);if(n)return n}}return null}walkMenu(e,t,r,n,o){var s;for(const a of e){const l=r[n++];l&&l.addEventListener("click",f=>{f.stopPropagation(),this.onMenuClick(a,o)}),(s=a.children)!=null&&s.length&&this.walkMenu(a.children,l,r,n,o)}}onMenuClick(e,t){var r;if(console.debug(`Menu clicked  ID: ${e.menuId}, Label: ${e.label}`),console.debug("MenuService:onMenuClick()/item:",Lt.inspect(e,{depth:2})),e.itemType==="action"&&e.action){console.debug(`[MenuService] Executing action for '${e.label}'`),e.action();return}if(e.itemType==="route"&&e.route&&e.controller){console.debug(`[MenuService] Loading route content for '${e.label}'`),this.loadResource({cdToken:t,item:e});return}if(e.itemType==="template"&&e.template&&e.controller){console.debug(`[MenuService] Loading template for '${e.label}'`),this.loadResource({cdToken:t,item:e});return}if(e.children&&e.children.length>0){console.debug(`[MenuService] Toggling menu node expansion for '${e.label}'`);const n=(r=document.querySelector(`[data-id="${e.menuId}"]`))==null?void 0:r.closest("li.cd-menu-item");if(n){n.classList.toggle("expanded");const o=n.querySelector(".cd-submenu");o&&o.classList.toggle("open")}return}console.warn(`[MenuService] Unhandled menu item type '${e.itemType}' for label '${e.label}'`)}async loadResource(e={}){console.log("MenuService::loadResource()/start..."),console.log("[MenuService][loadResource] options:",e);const{cdToken:t,item:r}=e;if(!r){console.error("MenuService.loadResource() called without a valid MenuItem.");return}const n=$e.getInstance(),o=document.getElementById("cd-main-content");let s;if(this.activeController&&typeof this.activeController.__deactivate=="function"&&(console.log("MenuService::loadResource()/01: Executing __deactivate() on active controller"),await this.activeController.__deactivate()),console.log("MenuService::loadResource()/02: Retrieving controller via cache service"),s=await n.getOrInitializeController(r.route||`${r.moduleId}-${r.label}`,r.controller),!s){console.error(`[MenuService] Failed to initialize controller for route: ${r.route}`);return}let a=0;for(;(!s.uiSystemLoader||!s.svCdAdmin)&&a<10;)console.warn(`[MenuService] Waiting for controller services to initialize... attempt ${a+1}`),await new Promise(l=>setTimeout(l,20)),a++;if(o){console.log("MenuService::loadResource()/03: Injecting template into DOM");let l="";typeof r.template=="function"?l=r.template.call(s):typeof s.__template=="function"?l=s.__template.call(s):l=r.template||"",o.innerHTML=l}typeof s.__activate=="function"&&(console.log("MenuService::loadResource()/04: Executing __activate()"),await s.__activate()),typeof s.__afterInit=="function"&&(console.log("MenuService::loadResource()/05: Executing __afterInit()"),await s.__afterInit()),this.activeController=s,console.log("MenuService::loadResource()/end")}getActiveController(){return this._activeController}setActiveController(e){this._activeController=e}renderMenuHtml(e){return e.map((t,r)=>{const n=t.children&&t.children.length>0,o=t.icon?btoa(JSON.stringify(t.icon)):"",s=t.itemType||"route",a=t.route||"",l=t.menuId||`auto-${r}-${Math.random().toString(36).slice(2,8)}`;return t.menuId=l,`
        <li
          id="menu-item-${l}"
          class="cd-menu-item"
          data-id="${l}"
          data-type="${s}"
          data-route="${a}"
          ${o?`data-icon="${o}"`:""}
          tabindex="0"
          role="button"
        >
          <a href="#" class="cd-menu-link" data-id="${l}">
            <span class="cd-menu-label">${t.label}</span>
            ${n?'<span class="cd-menu-toggle-icon fa fa-chevron-right"></span>':""}
          </a>
          ${n?`<ul class="cd-submenu">${this.renderMenuHtml(t.children)}</ul>`:""}
        </li>
      `}).join("")}menuAdapterFactory(e){switch(e){case"metismenu":return new Qr;case"plain":default:return null}}toKebabCase(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase()}assignMenuIds(e,t=""){return e.map(r=>{const n=r.label||r.route||"item",o=`menu-item-${t?t+"-":""}${this.toKebabCase(n)}`,s={...r,menuId:o};return r.children&&r.children.length>0&&(s.children=this.assignMenuIds(r.children,this.toKebabCase(n))),s})}prepareMenu(e){const t=this.assignMenuIds(e);return this.ensureItemTypes(t)}ensureItemTypes(e){return e.map(t=>{let r="route";t.itemType?r=t.itemType:t.action?r="action":t.template?r="template":t.route&&(r="route");const n={...t,itemType:r};return t.children&&t.children.length>0&&(n.children=this.ensureItemTypes(t.children)),n})}}class Ti{constructor(e={}){this.context=e.context||"Shell",this.level=e.level||"debug",this.silent=e.silent||!1}shouldLog(e){const t={debug:0,info:1,warn:2,error:3};return t[e]>=t[this.level]}log(e,t,...r){if(this.silent||!this.shouldLog(e))return;const n=`[${this.context.toUpperCase()}] [${e.toUpperCase()}]`;switch(e){case"debug":console.debug(n,t,...r);break;case"info":console.info(n,t,...r);break;case"warn":console.warn(n,t,...r);break;case"error":console.error(n,t,...r);break}}debug(e,...t){this.log("debug",e,...t)}info(e,...t){this.log("info",e,...t)}warn(e,...t){this.log("warn",e,...t)}error(e,...t){this.log("error",e,...t)}setContext(e){this.context=e}setLevel(e){this.level=e}silence(){this.silent=!0}unsilence(){this.silent=!1}}const Ae=class Ae{async loadThemeConfig(e="default"){console.debug(`ThemeService::loadThemeConfig(${e})`);const t=await fetch(`/themes/${e}/theme.json`);if(!t.ok)throw new Error(`Failed to load theme config: ${t.statusText}`);const r=await t.json();return Ae.setActiveTheme(r),r}static setActiveTheme(e){Ae.currentTheme=e,e!=null&&e.colors&&Object.entries(e.colors).forEach(([t,r])=>{const n=String(r);document.documentElement.style.setProperty(`--cd-${t}-color`,n)})}static get layout(){var e;return((e=Ae.currentTheme)==null?void 0:e.layout)||{}}static get activeTheme(){return Ae.currentTheme}};Ae.currentTheme=null;let jt=Ae;const Ci="modulepreload",Oi=function(i){return"/"+i},dr={},W=function(e,t,r){let n=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),a=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));n=Promise.allSettled(t.map(l=>{if(l=Oi(l),l in dr)return;dr[l]=!0;const f=l.endsWith(".css"),v=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${v}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":Ci,f||(g.as="script"),g.crossOrigin="",g.href=l,a&&g.setAttribute("nonce",a),document.head.appendChild(g),f)return new Promise((L,x)=>{g.addEventListener("load",L),g.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${l}`)))})}))}function o(s){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=s,window.dispatchEvent(a),!a.defaultPrevented)throw s}return n.then(s=>{for(const a of s||[])a.status==="rejected"&&o(a.reason);return e().catch(o)})};let Pi,tt,Dr;const Ii=async()=>{if(typeof window>"u")try{const[i,e,t]=await Promise.all([W(()=>import("./__vite-browser-external_fs-DU1_jvsO.js"),[]),W(()=>import("./__vite-browser-external_path-SE2pKm0_.js"),[]),W(()=>import("./url-BxhVZApR.js").then(r=>r.u),[])]);Pi=i,tt=e,Dr=t}catch(i){console.error("[ModuleService] Failed to load Node.js modules:",i)}},ee=class ee{constructor(){this.modules={},console.debug("[ModuleService][constructor]: starting"),this.isViteMode?(console.debug("[ModuleService] Running under Vite (browser)."),this.modules=Object.assign({"/src/CdShell/app/cd-ai/view/index.js":()=>W(()=>Promise.resolve().then(()=>Bi),void 0),"/src/CdShell/app/cd-geo/view/index.js":()=>W(()=>import("./index-DIGhDJk_.js"),[]),"/src/CdShell/app/coops/view/index.js":()=>W(()=>import("./index-YhLg4ZnN.js"),[]),"/src/CdShell/app/ui-adaptor-port/view/index.js":()=>W(()=>Promise.resolve().then(()=>Fi),void 0),"/src/CdShell/sys/base/view/index.js":()=>W(()=>Promise.resolve().then(()=>xi),void 0),"/src/CdShell/sys/cd-admin/view/index.js":()=>W(()=>import("./index-bOvGPjop.js"),__vite__mapDeps([0,1])),"/src/CdShell/sys/cd-comm/view/index.js":()=>W(()=>import("./index-qmd1dUUN.js"),[]),"/src/CdShell/sys/cd-guig/view/index.js":()=>W(()=>Promise.resolve().then(()=>Ui),void 0),"/src/CdShell/sys/cd-platform/view/index.js":()=>W(()=>Promise.resolve().then(()=>Ni),void 0),"/src/CdShell/sys/cd-push/view/index.js":()=>W(()=>import("./index-DMjNbz6u.js"),[]),"/src/CdShell/sys/cd-scheduler/view/index.js":()=>W(()=>Promise.resolve().then(()=>zi),void 0),"/src/CdShell/sys/cd-store/view/index.js":()=>W(()=>Promise.resolve().then(()=>Vi),void 0),"/src/CdShell/sys/cd-user/view/index.js":()=>W(()=>import("./index-BEx0eJtE.js"),__vite__mapDeps([2,1])),"/src/CdShell/sys/dev-descriptor/view/index.js":()=>W(()=>Promise.resolve().then(()=>Gi),void 0),"/src/CdShell/sys/dev-sync/view/index.js":()=>W(()=>import("./index-Cfy3-rsD.js"),[]),"/src/CdShell/sys/moduleman/view/index.js":()=>W(()=>Promise.resolve().then(()=>Wi),void 0),"/src/CdShell/sys/theme/view/index.js":()=>W(()=>Promise.resolve().then(()=>qi),void 0),"/src/CdShell/sys/utils/view/index.js":()=>W(()=>Promise.resolve().then(()=>Hi),void 0)})):console.debug("[ModuleService] Running under Node (non-Vite).")}static getInstance(){return ee.instance||(ee.instance=new ee),ee.instance}get isBrowser(){return typeof window<"u"}get isViteMode(){return this.isBrowser}get baseDir(){return this.isViteMode?"/src/CdShell":tt==null?void 0:tt.resolve(process.cwd(),"dist-ts/CdShell")}static async ensureInitialized(){this.initPromise||(this.initPromise=Ii()),await this.initPromise}static async preloadModulesSequentially(){const e=ee.getInstance();for(const t of this.preloadModules)try{console.debug(`[Preload] Loading ${t.moduleId}`);const n=(await e.loadModule(t.ctx,t.moduleId)).controllers.find(o=>o.name===t.component);if(n!=null&&n.instance&&typeof n.instance.__setup=="function"){const o=n.instance;console.debug(`[Preload] Setting up ${t.component}`),await o.__setup()}else console.warn(`[Preload] Controller component '${t.component}' not found in module ${t.moduleId}.`);console.debug(`[Preload] Completed ${t.component}`)}catch(r){console.error(`[Preload] Failed ${t.moduleId}: ${r}`)}}async loadModule(e,t){await ee.ensureInitialized(),ee.hasPreloaded||(ee.hasPreloaded=!0,await ee.preloadModulesSequentially()),console.debug("ModuleService::loadModule()/01:");const r=this.isViteMode,n=this.baseDir,o=r?`src/CdShell/${e}/${t}/view/index.js`:`${n}/${e}/${t}/view/index.js`;if(console.debug("[ModuleService] expectedPathFragment:",o),r){console.debug("[ModuleService] 1");const l=Object.keys(this.modules).find(f=>f.replace(/^\.?\//,"")===o);if(!l)throw console.error("[ModuleService] Available module keys:",Object.keys(this.modules)),new Error(`[ModuleService] Module not found for ctx=${e}, moduleId=${t}`);try{console.debug("[ModuleService][loadModule] pathKey:",l);const f=this.modules[l],g=(await f()).module;if(!g)throw new Error(`Missing 'module' export in: ${l}`);console.debug("[ModuleService][loadModule] moduleInfo:",g),console.debug("[ModuleService][loadModule] moduleInfo.controllers:",g.controllers);const L=g.controllers.find(R=>R.default===!0);return g.isDefault&&L||console.debug(`[ModuleService] Loaded module metadata passively: ${t}. Setup skipped.`),console.log(`[ModuleService] Loaded '${t}' (Vite mode) at ${new Date().toLocaleString()}`),g}catch(f){throw console.error("[ModuleService] Browser import failed:",f),f}}const a=`${n.replace(/\\/g,"/").replace(/\/+$/,"")}/${e}/${t}/view/index.js`;console.debug("[ModuleService] Importing (Node):",a);try{const f=await import(Dr.pathToFileURL(a).href);return console.log(`[ModuleService] Loaded '${t}' (Node mode) at ${new Date().toLocaleString()}`),f.module}catch(l){throw console.error("[ModuleService] Node import failed:",l),l}}async getAllowedModules(){const e=[],t=await this.loadModule("sys","cd-user");t&&(t.isDefault=!0,e.push(t));const r=await this.loadModule("sys","cd-admin");return r&&(r.isDefault=!1,e.push(r)),e}};ee.initPromise=null,ee.hasPreloaded=!1,ee.preloadModules=[{ctx:"sys",moduleId:"dev-sync",component:"IdeAgentService"},{ctx:"sys",moduleId:"dev-sync",component:"IdeAgentClientService"}];let ct=ee;class $i{findControllerInfoByRoute(e,t){const r=t.split("/"),n=r[r.length-1];return console.log("[ControllerService][findControllerInfoByRoute] controllerName:",n),console.log("[ControllerService][findControllerInfoByRoute] mod:",Lt.inspect(e,{depth:2})),e.controllers.find(o=>o.name===n)}}class Me{constructor(e){this.configService=e,this.cache=new Map}static getInstance(e){if(!Me.instance){if(!e)throw new Error("SysCacheService must be initialized with ConfigService on first instantiation.");Me.instance=new Me(e)}return Me.instance}setLoaders(e,t){this._uiSystemLoader=e,this._uiThemeLoader=t}async loadAndCacheAll(){if(!this._uiSystemLoader||!this._uiThemeLoader)throw new Error("SysCacheService: loaders must be set before load.");if(this.cache.size>0)return;console.log("[SysCacheService] 01: Starting Eager Load");const e=await this.configService.loadConfig(),t=e.envConfig||{};this.cache.set("envConfig",t);const r=e.uiConfig;this.cache.set("uiConfig",r);const o=(await this._uiSystemLoader.fetchAvailableSystems(r)).map(g=>({id:g.id,name:g.name,version:g.version,description:g.description,cssUrl:g.cssUrl,jsUrl:g.jsUrl,assetPath:g.assetPath,stylesheets:g.stylesheets||[],scripts:g.scripts||[],themesAvailable:g.themesAvailable||[],themeActive:g.themeActive||null,conceptMappings:g.conceptMappings||{},directiveMap:g.directiveMap||{},tokenMap:g.tokenMap||{},containers:g.containers||[],components:g.components||[],renderRules:g.renderRules||{},metadata:g.metadata||{},extensions:g.extensions||{},author:g.author,license:g.license,repository:g.repository,displayName:g.displayName||g.name})),s=o.map(g=>({id:g.id,name:g.name,displayName:g.displayName,themesAvailable:g.themesAvailable})),a=await this._uiThemeLoader.fetchAvailableThemes(r),l=(a.themes||[]).map(g=>({id:g.id,name:g.name})),f=(a.variants||[]).map(g=>({id:g.id,name:g.name})),v=a.descriptors||[];this.cache.set("uiSystems",s),this.cache.set("uiSystemDescriptors",o),this.cache.set("themes",l),this.cache.set("formVariants",f),this.cache.set("themeDescriptors",v),this.cache.set("uiConfigNormalized",a.uiConfig||r),console.log("[SysCacheService] Load complete.")}get(e){return this.cache.get(e)}getUiSystems(){return this.cache.get("uiSystems")||[]}getUiSystemDescriptors(){return this.cache.get("uiSystemDescriptors")||[]}getThemes(){return this.cache.get("themes")||[]}getFormVariants(){return this.cache.get("formVariants")||[]}getThemeDescriptors(){return this.cache.get("themeDescriptors")||[]}getConfig(){return this.cache.get("uiConfigNormalized")||{}}getEnvConfig(){return this.cache.get("envConfig")||{}}getConsumerGuid(){var t;const e=this.getEnvConfig();return(e==null?void 0:e.consumerGuid)||((t=e==null?void 0:e.clientContext)==null?void 0:t.consumerToken)||void 0}getApiEndpoint(){var e;return(e=this.getEnvConfig())==null?void 0:e.apiEndpoint}async ensureReady(){this.cache.size===0&&await this.loadAndCacheAll()}}function M(i,e={}){console.log(`%c[CSS-DIAG] ${i}`,"background:#222;color:#0f0;padding:2px 4px;border-radius:3px",e)}function ji(){const i=document.getElementById("cd-sidebar");if(!i)return;const e=window.getComputedStyle(i);console.warn("%c[SIDEBAR-DIAG] Sidebar State:","background:#440;color:#fff;padding:3px"),console.log("display:",e.display),console.log("position:",e.position),console.log("width:",e.width),console.log("flex-direction:",e.flexDirection),console.log("css file winning:",i)}const Ut=class Ut{static register(e,t){console.log("[UiSystemAdapterRegistry] register:",e,t),this.registry.set(e,t)}static get(e){return this.registry.get(e)||null}static list(){return Array.from(this.registry.keys())}};Ut.registry=new Map;let he=Ut;const Li=Object.freeze(Object.defineProperty({__proto__:null,UiSystemAdapterRegistry:he},Symbol.toStringTag,{value:"Module"}));class ki{async activate(e){console.log(`[${this.constructor.name}] activate() descriptor.id =`,e==null?void 0:e.id),console.log(`[${this.constructor.name}] activate() descriptor.version =`,e==null?void 0:e.version)}async deactivate(){document.documentElement.removeAttribute("data-bs-theme")}async applyTheme(e){try{if(!e)return;let t;typeof e=="string"?t=e==="dark"?"dark":"light":typeof e=="object"&&(t=e.mode||(e.id==="dark"?"dark":"light")),document.documentElement.setAttribute("data-bs-theme",t==="dark"?"dark":"light"),console.log("[Bootstrap502Adapter] applied bs-theme:",t)}catch(t){console.warn("[Bootstrap502Adapter] applyTheme error",t)}}}he.register("bootstrap-502",new ki);class Rr{constructor(){this.descriptor=null,this.observer=null,this.appliedSet=new WeakSet,console.log("%c[Bootstrap538AdapterService] constructor()","color:#6cf")}async activate(e){M("[Bootstrap538Adapter] activate() START",{id:e==null?void 0:e.id}),this.descriptor=e||null,e!=null&&e.conceptMappings?console.log("%c[Bootstrap538Adapter] Loaded conceptMappings:","color:#0ff",e.conceptMappings):console.warn("%c[Bootstrap538Adapter] descriptor.conceptMappings missing!","color:orange"),M("[Bootstrap538Adapter] Initial mapAll() pass"),this.mapAll(),this.observeMutations(),M("[Bootstrap538Adapter] activate() COMPLETE",{active:e==null?void 0:e.id})}async deactivate(){M("[Bootstrap538Adapter] deactivate() START");try{document.documentElement.removeAttribute("data-bs-theme"),console.log("[Bootstrap538Adapter] removed data-bs-theme")}catch{}if(this.observer){try{this.observer.disconnect(),console.log("[Bootstrap538Adapter] MutationObserver disconnected")}catch{}this.observer=null}this.descriptor=null,this.appliedSet=new WeakSet,M("[Bootstrap538Adapter] deactivate() COMPLETE")}async applyTheme(e){M("[Bootstrap538Adapter] applyTheme()",{themeDescriptorOrId:e});try{if(!e){console.warn("[Bootstrap538Adapter] applyTheme ignored (null theme)");return}let t;typeof e=="string"?t=e==="dark"?"dark":"light":typeof e=="object"&&(t=e.mode||(e.id==="dark"?"dark":"light")),document.documentElement.setAttribute("data-bs-theme",t==="dark"?"dark":"light"),M("[Bootstrap538Adapter] applied Bootstrap theme",{mode:t})}catch(t){console.warn("[Bootstrap538Adapter] applyTheme error",t)}}getMapping(e){console.log("[Bootstrap538Adapter] getMapping() this.descriptor:",this.descriptor);const t=this.descriptor&&this.descriptor.conceptMappings&&this.descriptor.conceptMappings[e]||void 0;return console.log(`%c[Bootstrap538Adapter] getMapping('${e}') =`,"color:#9f9",t),t}applyMappingToElement(e,t){if(t){if(this.appliedSet.has(e)){t.attrs&&Object.entries(t.attrs).forEach(([r,n])=>e.setAttribute(r,n));return}console.log("%c[Bootstrap538Adapter] Applying mapping to element:","color:#7ff;",{tag:e.tagName,mapping:t}),t.class&&t.class.split(/\s+/).forEach(r=>{r&&e.classList.add(r)}),t.attrs&&Object.entries(t.attrs).forEach(([r,n])=>e.setAttribute(r,n)),this.appliedSet.add(e)}}mapButtons(){const e=this.getMapping("button");if(!e)return;const r=document.querySelectorAll("button[cdButton], button.cd-button");M("[Bootstrap538Adapter] mapButtons()",{count:r.length}),r.forEach(n=>this.applyMappingToElement(n,e))}mapInputs(){const e=this.getMapping("input");if(!e)return;const r=document.querySelectorAll("input[cdFormControl], textarea[cdFormControl], select[cdFormControl]");M("[Bootstrap538Adapter] mapInputs()",{count:r.length}),r.forEach(n=>this.applyMappingToElement(n,e))}mapFormGroups(){const e=this.getMapping("formGroup");if(!e)return;const r=document.querySelectorAll(".cd-form-field");M("[Bootstrap538Adapter] mapFormGroups()",{count:r.length}),r.forEach(n=>this.applyMappingToElement(n,e))}mapOtherConcepts(){const e=this.descriptor&&this.descriptor.conceptMappings||{},t=Object.keys(e).filter(r=>!["button","input","formGroup"].includes(r));M("[Bootstrap538Adapter] mapOtherConcepts()",{concepts:t}),t.forEach(r=>{const n=e[r],o=`[data-cd-${r}], .cd-${r}`;document.querySelectorAll(o).forEach(a=>this.applyMappingToElement(a,n))})}mapAll(){console.log("%c[Bootstrap538Adapter] mapAll()  START","background:#444;color:#aaf;padding:2px");try{this.mapButtons(),this.mapInputs(),this.mapFormGroups(),this.mapOtherConcepts()}catch(e){console.warn("[Bootstrap538Adapter] mapAll error",e)}console.log("%c[Bootstrap538Adapter] mapAll()  END","background:#444;color:#aaf;padding:2px")}observeMutations(){if(!this.observer){M("[Bootstrap538Adapter] MutationObserver ATTACH"),this.observer=new MutationObserver(e=>{console.log("%c[Bootstrap538Adapter] Mutation detected  scheduling mapAll()","color:#ffa;"),"requestIdleCallback"in window?window.requestIdleCallback(()=>this.mapAll()):setTimeout(()=>this.mapAll(),16)});try{this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!1})}catch(e){console.warn("[Bootstrap538Adapter] observer failed to attach",e),this.observer=null}}}}he.register("bootstrap-538",new Rr);class Br{constructor(){this.descriptor=null,this.observer=null,this.appliedSet=new WeakSet,this.mdcInitQueued=!1,this.mdcInstances=new Set,console.log("%c[MaterialDesignAdapter] constructor()","color:#8cf")}async activate(e){M("[MaterialDesignAdapter] activate() START",{id:e==null?void 0:e.id}),this.descriptor=e||null,e!=null&&e.conceptMappings?console.log("%c[MaterialDesignAdapter] Loaded conceptMappings:","color:#0ff",e.conceptMappings):console.warn("[MaterialDesignAdapter] descriptor.conceptMappings missing!"),this.mapAll(),this.observeMutations(),M("[MaterialDesignAdapter] activate() COMPLETE",{active:e==null?void 0:e.id})}async deactivate(){M("[MaterialDesignAdapter] deactivate() START");try{document.documentElement.removeAttribute("data-md-theme")}catch{}if(this.observer){try{this.observer.disconnect()}catch{}this.observer=null}this.descriptor=null,this.appliedSet=new WeakSet;try{this.mdcInstances.forEach(e=>{var t;try{(t=e.destroy)==null||t.call(e)}catch{}}),this.mdcInstances.clear()}catch{}M("[MaterialDesignAdapter] deactivate() COMPLETE")}async applyTheme(e){M("[MaterialDesignAdapter] applyTheme()",{themeDescriptorOrId:e});try{if(!e){console.warn("[MaterialDesignAdapter] applyTheme ignored (null theme)");return}let t;typeof e=="string"?t=e==="dark"?"dark":"light":typeof e=="object"&&(t=e.mode||(e.id==="dark"?"dark":"light")),document.documentElement.setAttribute("data-md-theme",t==="dark"?"dark":"light"),M("[MaterialDesignAdapter] applied Material theme",{mode:t})}catch(t){console.warn("[MaterialDesignAdapter] applyTheme error",t)}}getMapping(e){const t=this.descriptor&&this.descriptor.conceptMappings&&this.descriptor.conceptMappings[e]||void 0;return console.log(`%c[MaterialDesignAdapter] getMapping('${e}') =`,"color:#9f9",t),t}applyMappingToElement(e,t){if(t){if(this.appliedSet.has(e)){t.attrs&&Object.entries(t.attrs).forEach(([r,n])=>e.setAttribute(r,n));return}console.log("%c[MaterialDesignAdapter] Applying mapping to element:","color:#7ff;",{tag:e.tagName,mapping:t}),t.class&&t.class.split(/\s+/).forEach(r=>r&&e.classList.add(r)),t.attrs&&Object.entries(t.attrs).forEach(([r,n])=>e.setAttribute(r,n)),this.appliedSet.add(e)}}prepareMdcDom(e){var s;if(!e)return null;if(e.dataset.mdTransformed==="1")return e.querySelector(".mdc-text-field, .cd-md-select-wrapper, .cd-md-text-field, .mdc-select")||null;const t=e.querySelector("input, textarea, select"),r=e.querySelector("label");if(!t)return console.warn("[prepareMdcDom] no input/textarea/select inside field  skipping",{field:e}),null;const n=(((s=r==null?void 0:r.textContent)==null?void 0:s.trim())||t.getAttribute("placeholder")||t.name||"").trim();try{"placeholder"in t&&(t.placeholder="")}catch{}t.id||(t.id=`mdc-${Math.random().toString(36).slice(2,8)}`);const o=(t.tagName||"").toUpperCase();if(o==="INPUT"||o==="TEXTAREA"){const a=document.createElement("label");a.className="mdc-text-field mdc-text-field--filled cd-md-text-field";const l=document.createElement("span");l.className="mdc-text-field__ripple";const f=document.createElement("span");f.className="mdc-floating-label",f.setAttribute("for",t.id),f.textContent=n||"",t.classList.add("mdc-text-field__input");const v=document.createElement("span");v.className="mdc-line-ripple",a.appendChild(l),a.appendChild(f),a.appendChild(t),a.appendChild(v);try{e.replaceWith(a),a.dataset.mdTransformed="1"}catch(g){return console.warn("[prepareMdcDom] replaceWith failed (input)",g,{field:e,wrapper:a}),null}return a}else if(o==="SELECT"){const a=t;let l="";a.options.length>0&&a.options[0].value===""&&(l=a.options[0].text||"",a.remove(0));const f=document.createElement("div");f.className="mdc-select mdc-select--filled cd-md-select-wrapper",f.setAttribute("role","listbox"),a.style.display="none",a.classList.remove("mdc-text-field__input"),f.appendChild(a);const v=document.createElement("div");v.className="mdc-select__anchor",v.setAttribute("role","button"),v.setAttribute("aria-haspopup","listbox"),v.setAttribute("aria-expanded","false"),v.setAttribute("aria-labelledby",`${t.id}-label ${t.id}-selected-text`),v.tabIndex=0;const g=document.createElement("span");g.className="mdc-select__ripple",v.appendChild(g);const L=document.createElement("span");L.className="mdc-floating-label",L.id=`${t.id}-label`,L.textContent=n||l,v.appendChild(L);const x=document.createElement("span");x.className="mdc-select__selected-text-container";const R=document.createElement("span");R.className="mdc-select__selected-text",R.id=`${t.id}-selected-text`,R.textContent="",x.appendChild(R),v.appendChild(x);const z=document.createElement("span");z.className="mdc-select__dropdown-icon",z.innerHTML=`
      <svg class="mdc-select__dropdown-icon-graphic" viewBox="7 10 10 5" focusable="false">
        <polygon class="mdc-select__dropdown-icon-inactive" stroke="none" fill-rule="evenodd" points="7 10 12 15 17 10"></polygon>
        <polygon class="mdc-select__dropdown-icon-active" stroke="none" fill-rule="evenodd" points="7 15 12 10 17 15"></polygon>
      </svg>`,v.appendChild(z);const F=document.createElement("span");F.className="mdc-line-ripple",v.appendChild(F),f.appendChild(v);const G=document.createElement("div");G.className="mdc-select__menu mdc-menu mdc-menu-surface cd-md-select-menu",G.setAttribute("role","presentation"),G.setAttribute("aria-hidden","true");const V=document.createElement("ul");V.className="mdc-list",V.setAttribute("role","listbox"),V.setAttribute("tabindex","-1"),Array.from(a.options).forEach((U,K)=>{const Z=document.createElement("li");Z.className="mdc-list-item",Z.setAttribute("role","option"),Z.setAttribute("data-value",U.value),Z.setAttribute("data-index",String(K)),Z.tabIndex=-1;const re=document.createElement("span");re.className="mdc-list-item__ripple";const ue=document.createElement("span");ue.className="mdc-list-item__text",ue.textContent=U.text,Z.appendChild(re),Z.appendChild(ue),V.appendChild(Z)}),G.appendChild(V),f.appendChild(G);try{e.replaceWith(f),f.dataset.mdTransformed="1"}catch(U){return console.warn("[prepareMdcDom] replaceWith failed (select)",U,{field:e,wrapper:f}),null}return f.__cd_native_select=a,f.__cd_anchor=v,f.__cd_selected_text=R,f.__cd_menu_el=G,f}else return console.warn("[prepareMdcDom] unknown control tag  skipping",{tag:o,field:e}),null}attachCssFallback(e){try{const t=e.querySelector("input, textarea, select");if(!t)return;t.value&&t.value.length>0&&e.classList.add("mdc-text-field--focused"),t.__cd_md_handlers_attached||(t.addEventListener("focus",()=>e.classList.add("mdc-text-field--focused")),t.addEventListener("blur",()=>{(!t.value||t.value.length===0)&&e.classList.remove("mdc-text-field--focused")}),t.__cd_md_handlers_attached=!0)}catch(t){console.warn("[attachCssFallback] error",t)}}initMdcTextField(e){if(e)try{const t=window.mdc;if(!e.classList.contains("mdc-text-field")||e.__cd_mdc_initialized)return;if(!t||!t.textField||!t.textField.MDCTextField){this.attachCssFallback(e);return}const r=e.querySelector(".mdc-text-field__input");if(!r){this.attachCssFallback(e);return}if(!(typeof r.validity<"u")){this.attachCssFallback(e);return}try{const o=new t.textField.MDCTextField(e);this.mdcInstances.add(o),e.__cd_mdc_initialized=!0,console.debug("[MaterialDesignAdapter] MDCTextField constructed",{wrapper:e,inst:o})}catch(o){console.warn("[MaterialDesignAdapter] MDCTextField construction failed  falling back to CSS handlers",o),e.__cd_mdc_initialized=!1,this.attachCssFallback(e)}}catch(t){console.error("[MaterialDesignAdapter] initMdcTextField fatal",t),this.attachCssFallback(e)}}initMdcSelect(e){if(e)try{if(e.__cd_select_initialized)return;const t=window.mdc,r=e.__cd_native_select,n=e.__cd_anchor,o=e.__cd_selected_text,s=e.__cd_menu_el;if(!r||!n||!s){this.initMdcSelectFallback(e),e.__cd_select_initialized=!0;return}if(o.textContent="",t&&t.select&&t.select.MDCSelect)try{const a=new t.select.MDCSelect(e);this.mdcInstances.add(a),e.__cd_mdc_select_inst=a,a.selectedIndex===0&&r.selectedIndex>-1&&(a.selectedIndex=-1),a.listen("MDCSelect:change",()=>{var l;try{const f=a.selectedIndex;r.selectedIndex=f;const v=new Event("change",{bubbles:!0});r.dispatchEvent(v),o.textContent=a.selectedText||((l=r.options[f])==null?void 0:l.text)||""}catch(f){console.warn("[MaterialDesignAdapter] MDCSelect change error",f)}}),r.addEventListener("change",()=>{var f;const l=r.selectedIndex;o.textContent=((f=r.options[l])==null?void 0:f.text)||""}),e.__cd_select_initialized=!0;return}catch(a){console.warn("[MaterialDesignAdapter] MDCSelect init failed",a)}if(t&&t.menu&&t.menu.MDCMenu)try{const a=new t.menu.MDCMenu(s);s.__cd_mdc_menu_inst=a,this.mdcInstances.add(a),n.addEventListener("click",()=>{a.open=!a.open}),s.querySelectorAll(".mdc-list-item").forEach(l=>{l.addEventListener("click",()=>{var g;const f=Number(l.getAttribute("data-index"));r.selectedIndex=f;const v=new Event("change",{bubbles:!0});r.dispatchEvent(v),o.textContent=((g=r.options[f])==null?void 0:g.text)||"",a.open=!1})}),e.__cd_select_initialized=!0;return}catch(a){console.warn("[MaterialDesignAdapter] MDCMenu fallback failed",a)}this.initMdcSelectFallback(e),e.__cd_select_initialized=!0}catch(t){console.warn("[MaterialDesignAdapter] initMdcSelect fatal",t),this.initMdcSelectFallback(e),e.__cd_select_initialized=!0}}initMdcSelectFallback(e){try{if(e.__cd_select_fallback_attached)return;const t=e.__cd_menu_el,r=e.__cd_trigger,n=e.__cd_native_select,o=e.__cd_trigger_label;if(!t||!r||!n)return;let s=!1;const a=()=>{t.style.display="block",r.setAttribute("aria-expanded","true"),s=!0},l=()=>{t.style.display="none",r.setAttribute("aria-expanded","false"),s=!1};t.style.display="none",r.addEventListener("click",f=>{f.stopPropagation(),s?l():a()}),document.addEventListener("click",f=>{e.contains(f.target)||l()}),n.addEventListener("change",()=>{const f=n.options[n.selectedIndex];o.textContent=f?f.text:""}),e.__cd_select_fallback_attached=!0,console.debug("[MaterialDesignAdapter] JS fallback select/menu attached")}catch(t){console.warn("[MaterialDesignAdapter] initMdcSelectFallback error",t)}}scheduleMdcInit(){this.mdcInitQueued||(this.mdcInitQueued=!0,setTimeout(()=>{this.mdcInitQueued=!1,document.querySelectorAll(".cd-md-text-field, .cd-md-select-wrapper, .mdc-select").forEach(e=>{e.classList.contains("mdc-text-field")?e.__cd_mdc_initialized||this.initMdcTextField(e):(e.classList.contains("cd-md-select-wrapper")||e.classList.contains("mdc-select"))&&(e.__cd_select_initialized||this.initMdcSelect(e))})},40))}mapButtons(){const e=this.getMapping("button");if(!e)return;const r=document.querySelectorAll("button[cdButton], button.cd-button");M("[MaterialDesignAdapter] mapButtons()",{count:r.length}),r.forEach(n=>this.applyMappingToElement(n,e))}mapInputs(){const e=this.getMapping("input");if(!e)return;const t=Array.from(document.querySelectorAll(".cd-form-field"));M("[MaterialDesignAdapter] mapInputs()",{candidates:t.length}),t.forEach((r,n)=>{try{console.debug(`[MaterialDesignAdapter] mapInputs: FIELD #${n}`,{field:r});const o=this.prepareMdcDom(r);if(!o){console.debug("[MaterialDesignAdapter] mapInputs: prepareMdcDom returned null (skipping)");return}e.attrs&&Object.entries(e.attrs).forEach(([s,a])=>o.setAttribute(s,a)),this.appliedSet.add(o),o.classList.contains("mdc-text-field")?this.initMdcTextField(o):o.classList.contains("cd-md-select-wrapper")&&this.initMdcSelect(o),this.scheduleMdcInit(),console.debug("[MaterialDesignAdapter] mapInputs: transformed wrapper ",{wrapper:o})}catch(o){console.warn("[MaterialDesignAdapter] mapInputs error",o)}})}mapFormGroups(){const e=this.getMapping("formGroup");if(!e)return;const r=document.querySelectorAll(".cd-form-field");M("[MaterialDesignAdapter] mapFormGroups()",{count:r.length}),r.forEach(n=>{this.applyMappingToElement(n,e);try{this.prepareMdcDom(n)}catch{}})}mapOtherConcepts(){const e=this.descriptor&&this.descriptor.conceptMappings||{},t=Object.keys(e).filter(r=>!["button","input","formGroup"].includes(r));M("[MaterialDesignAdapter] mapOtherConcepts()",{concepts:t}),t.forEach(r=>{const n=e[r],o=`[data-cd-${r}], .cd-${r}`;document.querySelectorAll(o).forEach(a=>{this.applyMappingToElement(a,n);try{this.prepareMdcDom(a)}catch{}})})}mapAll(){console.log("%c[MaterialDesignAdapter] mapAll()  START","background:#223;color:#9cf;padding:2px");try{this.mapButtons(),this.mapInputs(),this.mapFormGroups(),this.mapOtherConcepts(),this.scheduleMdcInit()}catch(e){console.warn("[MaterialDesignAdapter] mapAll error",e)}console.log("%c[MaterialDesignAdapter] mapAll()  END","background:#223;color:#9cf;padding:2px")}observeMutations(){if(!this.observer){M("[MaterialDesignAdapter] MutationObserver ATTACH"),this.observer=new MutationObserver(e=>{"requestIdleCallback"in window?window.requestIdleCallback(()=>this.mapAll()):setTimeout(()=>this.mapAll(),24)});try{this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!1})}catch(e){console.warn("[MaterialDesignAdapter] observer failed to attach",e),this.observer=null}}}}he.register("material-design",new Br);class Di{async activate(e){console.log(`[${this.constructor.name}] activate() descriptor.id =`,e==null?void 0:e.id),console.log(`[${this.constructor.name}] activate() descriptor.version =`,e==null?void 0:e.version)}async deactivate(){document.documentElement.removeAttribute("data-md-theme")}async applyTheme(e){if(!e)return;const t=typeof e=="string"?e:e.mode;t==="dark"?(document.documentElement.classList.add("md-dark"),document.documentElement.classList.remove("md-light")):(document.documentElement.classList.remove("md-dark"),document.documentElement.classList.add("md-light")),console.log("[MaterialAdapter] applyTheme:",t)}}he.register("plain",new Di);new Rr,new Br;const _t={id:"bootstrap-538",version:"5.3.8",themeActive:"light"},we=class we{constructor(e){this.activeSystem=null,this.sysCache=e}static getInstance(e){if(!we.instance){if(!e)throw new Error("UiSystemLoaderService.getInstance requires SysCacheService on first call.");we.instance=new we(e)}return we.instance}async fetchAvailableSystems(e){const t=e.uiSystemBasePath||"/public/assets/ui-systems/",r=he.list();console.log("[UiSystemLoaderService] Registered UI Systems:",r);const n=[];for(const o of r){const s=`${t}${o}/descriptor.json`;try{console.log(`[UiSystemLoaderService] Loading descriptor: ${s}`);const a=await fetch(s);if(!a.ok)throw new Error(`HTTP ${a.status}`);const l=await a.json(),f=`${t}${o}/`;n.push({...l,id:o,cssUrl:l.cssUrl?f+l.cssUrl:void 0,jsUrl:l.jsUrl?f+l.jsUrl:void 0,stylesheets:(l.stylesheets||[]).map(v=>f+v),scripts:(l.scripts||[]).map(v=>f+v),themesAvailable:l.themesAvailable||[],themeActive:l.themeActive||null,conceptMappings:l.conceptMappings||{},directiveMap:l.directiveMap||{}})}catch(a){console.warn(`[UiSystemLoaderService] Failed to load ${s}`,a);const l=`${t}${o}/`;n.push({id:o,name:o,version:"unknown",cssUrl:`${l}${o}.min.css`,jsUrl:`${l}${o}.min.js`,stylesheets:[],scripts:[],conceptMappings:{},themesAvailable:[],themeActive:null})}}return n}list(){return this.sysCache.get("uiSystems")||[]}getSystemById(e){return(this.sysCache.get("uiSystems")||[]).find(r=>r.id===e)}async activate(e){var l;if(M("[UiSystemLoaderService.activate] START",{id:e}),await this.sysCache.ensureReady(),!e){const f=(l=this.detectUiSystem)==null?void 0:l.call(this);f!=null&&f.id&&(e=f.id)}const t=this.getFullDescriptor(e);console.log("[UiSystemLoaderService.activate] descriptorFromCache:",t);const r={id:e,cssUrl:`/assets/ui-systems/${e}/${e}.min.css`,jsUrl:`/assets/ui-systems/${e}/${e}.min.js`,assetPath:`/assets/ui-systems/${e}`,stylesheets:[],scripts:[],conceptMappings:{},directiveMap:{},metadata:{},extensions:{}},n=t||r;this.activeSystem=n;try{window.CdActiveUiDescriptor=n,window.CD_ACTIVE_UISYSTEM=e,window.CdShellActiveUiSystem=e}catch(f){console.warn("[UiSystemLoaderService.activate] Could not set global descriptor",f)}document.querySelectorAll("link[data-cd-uisystem], script[data-cd-uisystem]").forEach(f=>f.remove()),M("[UiSystemLoaderService.activate] REMOVED OLD SYSTEM ASSETS",{});const o=n.cssUrl||`${n.assetPath||`/assets/ui-systems/${e}`}/bootstrap.min.css`,s=n.jsUrl||`${n.assetPath||`/assets/ui-systems/${e}`}/${e}.min.js`,a=`${n.assetPath||`/assets/ui-systems/${e}`}/bridge.css`;M("[UiSystemLoaderService.activate] RESOLVED PATHS",{cssPath:o,jsPath:s,bridgeCssPath:a});try{await this.loadCSS(o,e),M("[UiSystemLoaderService.activate] CSS LOADED",{cssPath:o})}catch(f){M("[UiSystemLoaderService.activate] CSS LOAD FAILED",{cssPath:o,err:f})}try{await this.loadCSS(a,`${e}-bridge`),M("[UiSystemLoaderService.activate] BRIDGE CSS LOADED",{bridgeCssPath:a})}catch(f){console.log(`[UiSystemLoaderService.activate] bridge.css not found for ${e} (optional)`),M("[UiSystemLoaderService.activate] BRIDGE CSS LOAD FAILED",{bridgeCssPath:a,err:f})}try{await this.loadScript(s,e),M("[UiSystemLoaderService.activate] SCRIPT LOADED",{jsPath:s})}catch(f){console.warn("[UiSystemLoaderService.activate] script load failed",f),M("[UiSystemLoaderService.activate] SCRIPT LOAD FAILED",{jsPath:s,err:f})}try{const{UiSystemAdapterRegistry:f}=await W(async()=>{const{UiSystemAdapterRegistry:g}=await Promise.resolve().then(()=>Li);return{UiSystemAdapterRegistry:g}},[]),v=f.get(e);v&&typeof v.activate=="function"?(await v.activate(n),M("[UiSystemLoaderService.activate] ADAPTER ACTIVATED",{id:e})):console.log(`[UiSystemLoaderService.activate] No in-app adapter registered for ${e} (skipping)`)}catch(f){console.warn("[UiSystemLoaderService.activate] adapter activation failed",f)}M("[UiSystemLoaderService.activate] COMPLETE",{activeSystem:e})}async applyTheme(e,t){M("[UiSystemLoaderService.applyTheme] start",{systemId:e,themeId:t});const r=he.get(e);if(console.log("[UiSystemLoaderService.applyTheme] adapter received:",r),!r){console.warn("[UiSystemLoaderService.applyTheme] no adapter for",e);return}const n=this.sysCache.get("themeDescriptors")||[];console.log("[UiSystemLoaderService][applyTheme] descriptors:",n);const o=n.find(s=>s.id===t);console.log("[UiSystemLoaderService][applyTheme] descriptors:",o),await r.applyTheme(o||t),M("[UiSystemLoaderService.applyTheme] done",{systemId:e,themeId:t})}async loadCSS(e,t){return M("[UiSystemLoaderService.loadCSS] REQUEST",{path:e,id:t}),new Promise((r,n)=>{try{const o=document.head||document.getElementsByTagName("head")[0];if(!o)return n(new Error("document.head missing"));const s=document.createElement("link");s.rel="stylesheet",s.href=e,s.setAttribute("data-cd-uisystem",t),s.setAttribute("data-cd-origin","ui-system"),s.onload=()=>{const a=s.href;M("[UiSystemLoaderService.loadCSS] LOADED",{path:e,id:t,resolved:a,order:Array.from(o.querySelectorAll("link")).map(l=>l.href)}),r(a)},s.onerror=a=>{M("[UiSystemLoaderService.loadCSS] ERROR",{path:e,id:t,ev:a}),n(new Error(`Failed to load CSS: ${e}`))},o.insertAdjacentElement("beforeend",s)}catch(o){M("[UiSystemLoaderService.loadCSS] EXCEPTION",{path:e,id:t,err:o}),n(o)}})}async loadScript(e,t){return new Promise((r,n)=>{try{const o=document.createElement("script");o.src=e,o.async=!0,o.setAttribute("data-cd-uisystem",t),o.setAttribute("data-cd-origin","ui-system"),o.onload=()=>r(),o.onerror=a=>n(a);const s=document.body||document.getElementsByTagName("body")[0];if(!s)return n(new Error("document.body missing"));s.appendChild(o)}catch(o){n(o)}})}getActive(){return console.log("[UiSystemLoaderService][getActive] start."),this.activeSystem}detectFromRuntime(){return window.CdShellActiveUiSystem||window.CD_ACTIVE_UISYSTEM||null}detectFromMeta(){const e=document.querySelector('meta[name="cd-uiform"]');return(e==null?void 0:e.content)||null}detectUiSystem(){const e=this.detectFromRuntime();if(e)return{..._t,id:e};const t=this.detectFromMeta();return t?{..._t,id:t}:_t}getFullDescriptor(e){return(this.sysCache.get("uiSystemDescriptors")||[]).find(r=>r.id===e)}};we.instance=null;let lt=we;const _e=class _e{constructor(){this.config=null,this.CONFIG_PATH="/shell.config.json"}static getInstance(){return _e.instance||(_e.instance=new _e),_e.instance}async loadConfig(){if(this.config)return this.config;try{const e=await fetch(this.CONFIG_PATH);if(!e.ok)throw new Error(`Failed to load config ${e.status}`);return this.config=await e.json(),console.log("[ConfigService] loaded config:",this.config),this.config}catch(e){return console.error("[ConfigService] loadConfig error:",e),this.config={appName:"Corpdesk",fallbackTitle:"Corpdesk",appVersion:"0.0.0",appDescription:"",themeConfig:{currentThemePath:"/themes/default/theme.json",accessibleThemes:["default","dark"]},defaultModulePath:"sys/cd-user",logLevel:"debug",uiConfig:{defaultUiSystemId:"bootstrap-538",defaultThemeId:"default",defaultFormVariant:"standard",uiSystemBasePath:"/public/assets/ui-systems/"}},this.config}}getUiConfig(){if(!this.config)throw new Error("ConfigService: config not loaded; call loadConfig()");return this.config.uiConfig}};_e.instance=null;let ke=_e;const ae=class ae{constructor(e){this.configService=ke.getInstance(),this.sysCache=e}static getInstance(e){if(!ae.instance){if(!e)throw new Error("UiThemeLoaderService.getInstance requires SysCacheService on first call.");ae.instance=new ae(e)}return ae.instance}async fetchAvailableThemes(e){var s,a;console.log("[UiThemeLoaderService][fetchAvailableThemes] start",e);const t=e&&e.accessibleThemes||((a=(s=this.configService.config)==null?void 0:s.themeConfig)==null?void 0:a.accessibleThemes)||["default","dark"],r=[];for(const l of t){const f=`/themes/${l}/theme.json`;try{const v=await fetch(f);if(!v.ok){console.warn(`[UiThemeLoaderService] theme descriptor not found: ${f}`);continue}const g=await v.json();r.push(g)}catch(v){console.warn(`[UiThemeLoaderService] error fetching theme descriptor ${f}`,v)}}return{themes:r.map(l=>({id:l.id,name:l.name})),variants:[{id:"standard",name:"Standard"},{id:"compact",name:"Compact"},{id:"floating",name:"Floating"}],descriptors:r,uiConfig:e}}async loadThemeById(e){M("[UiThemeLoaderService.loadThemeById] start",{themeId:e}),document.querySelectorAll("link[data-cd-theme]").forEach(n=>n.remove());const t=this.getThemeDescriptor(e);if(!t){M("[UiThemeLoaderService.loadThemeById] descriptor not found",{themeId:e});const n=`/themes/${e}/theme.css`;await this.injectStyle(n,e,"theme");return}const r=t.css||t.cssPath||`/themes/${e}/theme.css`;await this.injectStyle(r,e,"theme"),M("[UiThemeLoaderService.loadThemeById] loaded",{themeId:e,cssPath:r})}getThemeDescriptor(e){return(this.sysCache.get("themeDescriptors")||[]).find(r=>r.id===e)}async loadFormVariant(e="standard"){document.querySelectorAll("link[data-cd-form]").forEach(r=>r.remove());const t=`/themes/common/forms/variants/cd-form-${e}.css`;await this.injectStyle(t,e,"form")}async injectStyle(e,t,r="theme"){return new Promise((n,o)=>{try{const s=document.head||document.getElementsByTagName("head")[0];if(!s)return o(new Error("document.head missing"));const a=document.createElement("link");a.rel="stylesheet",a.href=e,r==="theme"?a.setAttribute("data-cd-theme",t):a.setAttribute("data-cd-form",t),a.onload=()=>n(),a.onerror=l=>o(new Error(`failed to load ${e}`)),s.insertAdjacentElement("beforeend",a)}catch(s){o(s)}})}getActiveThemeId(){return console.log("[UiThemeLoaderService][getActiveThemeId] start."),localStorage.getItem(ae.ACTIVE_THEME_KEY)||""}getActiveFormVariantId(){return localStorage.getItem(ae.ACTIVE_FORM_VARIANT_KEY)||"standard"}};ae.ACTIVE_THEME_KEY="cd-active-theme-id",ae.ACTIVE_FORM_VARIANT_KEY="cd-active-form-variant",ae.instance=null;let ut=ae;class Ri{constructor(){this.logger=new Ti,this.splashAnimDone=!1,this.appReady=!1,this.svConfig=new ke,this.svSysCache=new Me(this.svConfig)}async init(){this.logger.debug("[Main] init(): starting"),typeof window>"u"?(this.logger.debug("[Main] Running in Node  awaiting ensureInitialized()"),await ct.ensureInitialized()):this.logger.debug("[Main] Running in browser  skipping ensureInitialized()"),this.svConfig=new ke,this.svSysCache=new Me(this.svConfig),this.svModule=new ct,this.svMenu=new Ei,this.svController=new $i,this.svTheme=new jt;const e=await this.loadShellConfig();e.logLevel&&this.logger.setLevel(e.logLevel),this.logger.debug("[Main] init(): completed")}async run(){var R,z;await this.showSplash(),this.logger.setLevel("debug"),this.logger.debug("starting bootstrapShell()"),M("Main.run() started");const e=await this.loadShellConfig();e.logLevel&&this.logger.setLevel(e.logLevel),this.svUiSystemLoader=lt.getInstance(this.svSysCache),this.svUiThemeLoader=ut.getInstance(this.svSysCache),this.svSysCache.setLoaders(this.svUiSystemLoader,this.svUiThemeLoader),await this.svSysCache.loadAndCacheAll(),M("Cache loaded"),await this.applyStartupUiSettings(),M("UI-System + Theme applied");const t=await this.svTheme.loadThemeConfig();M("ThemeConfig loaded",t),document.title=e.appName||e.fallbackTitle||"Corpdesk";const r=document.getElementById("cd-logo");r&&t.logo&&(r.src=t.logo);const n=await this.svModule.getAllowedModules(),o=n.find(F=>F.isDefault),s=(R=o==null?void 0:o.controllers.find(F=>F.default))==null?void 0:R.name;M("Modules Loaded",{allowedModules:n});const a=n.flatMap(F=>{const G=V=>V.map(U=>{if(U.itemType==="route"&&U.route){const K=this.svController.findControllerInfoByRoute(F,U.route);K&&(U.controller=K.instance,U.template=typeof K.template=="function"?K.template:()=>K.template,U.moduleId=F.moduleId,F.isDefault&&K.name===s&&(U.moduleDefault=!0))}return U.children&&(U.children=G(U.children)),U});return G(F.menu||[])}),l=this.svMenu.prepareMenu(a);M("Menu prepared",l);try{const G=await(await fetch(e.themeConfig.currentThemePath)).json();this.svMenu.renderMenuWithSystem(l,G);const V=document.getElementById("cd-sidebar");V&&(!V.innerHTML||V.innerHTML.trim()==="")&&this.svMenu.renderPlainMenu(l,"cd-sidebar"),M("Sidebar rendered"),ji()}catch(F){console.error("[Main] Failed rendering menu",F)}try{const F=l.find(V=>V.label===(o==null?void 0:o.moduleId)),G=(z=F==null?void 0:F.children)==null?void 0:z.find(V=>V.moduleDefault);G&&await this.svMenu.loadResource({item:G}),M("Default controller loaded")}catch(F){console.warn("[Main] auto-load default view failed",F)}const f=document.getElementById("cd-burger"),v=document.getElementById("cd-sidebar"),g=document.getElementById("cd-overlay"),L=()=>window.matchMedia("(max-width: 900px)").matches,x=()=>{L()||(v.classList.remove("open"),g.classList.add("hidden"),f.classList.remove("open"))};f&&v&&g&&(f.addEventListener("click",()=>{f.classList.toggle("open"),v.classList.toggle("open"),g.classList.toggle("hidden")}),g.addEventListener("click",()=>{f.classList.remove("open"),v.classList.remove("open"),g.classList.add("hidden")}),window.addEventListener("resize",x),x()),this.logger.debug("[Main] app fully bootstrapped"),this.appReady=!0,this.tryHideSplash(),this.logger.debug("bootstrapShell(): run() complete"),M("Main.run() complete")}async applyStartupUiSettings(){ke.getInstance(),await this.svSysCache.ensureReady();const e=this.svSysCache.get("uiConfig");if(!e){console.warn("[Main.applyStartupUiSettings] uiConfig missing");return}const t=e.defaultUiSystemId,r=e.defaultThemeId;M("[MAIN.applyStartupUiSettings] start",{systemId:t,themeId:r});const n=lt.getInstance(this.svSysCache),o=ut.getInstance(this.svSysCache);try{await n.activate(t),M("[MAIN.applyStartupUiSettings] ui-system activated",{systemId:t})}catch(s){console.warn("[MAIN.applyStartupUiSettings] activate failed",s),M("[MAIN.applyStartupUiSettings] activate failed",{err:s})}try{await n.loadCSS("/themes/common/base.css","shell-base"),await n.loadCSS("/assets/css/index.css","shell-index"),M("[MAIN.applyStartupUiSettings] shell CSS loaded",{})}catch(s){console.warn("[MAIN.applyStartupUiSettings] shell CSS load failed",s)}try{await o.loadThemeById(r),M("[MAIN.applyStartupUiSettings] theme css injected",{themeId:r})}catch(s){console.warn("[MAIN.applyStartupUiSettings] theme load failed",s)}try{await n.applyTheme(t,r),M("[MAIN.applyStartupUiSettings] system applyTheme complete",{})}catch(s){console.warn("[MAIN.applyStartupUiSettings] applyTheme failed",s)}M("[MAIN.applyStartupUiSettings] done",{})}async loadShellConfig(){const e=await fetch("/shell.config.json");if(!e.ok)throw new Error(`Failed to load shell config: ${e.statusText}`);return await e.json()}async showSplash(){return new Promise(async e=>{var a,l;const t=document.getElementById("cd-splash");if(!t)return e();const r=await this.loadShellConfig(),n=(a=r.splash)==null?void 0:a.path,o=((l=r.splash)==null?void 0:l.minDuration)??3e3;this.logger.debug("[Splash] loading",{path:n,minDuration:o});const s=await fetch(n).then(f=>f.text());t.innerHTML=s,t.style.display="block",setTimeout(()=>{this.logger.debug("[Splash] animation completed"),this.splashAnimDone=!0,this.tryHideSplash()},o),e()})}async tryHideSplash(){if(!this.splashAnimDone||!this.appReady){this.logger.debug("[Splash] waiting",{splashAnimDone:this.splashAnimDone,appReady:this.appReady});return}this.logger.debug("[Splash] conditions met  hiding splash"),await this.hideSplash()}async hideSplash(){return new Promise(e=>{const t=document.getElementById("cd-splash"),r=document.getElementById("cd-root");if(!t)return e();const n=t.querySelector("#splash-container");n==null||n.classList.add("fade-out"),setTimeout(()=>{t.remove(),r&&(r.style.visibility="visible"),this.logger.debug("[Splash] removed, app revealed"),e()},800)})}}console.log("start 1");const Fr=new Ri;Fr.init();Fr.run().catch(i=>{console.error("[BOOTSTRAP ERROR]",i)});const Bi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Fi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),xi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Ui=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Ni=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),zi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Vi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Gi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Wi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),qi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),Hi=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));export{ke as C,Me as S,lt as U,ut as a,Mr as b,rt as c,Ve as d,Ji as g,xe as t,Lt as u};
